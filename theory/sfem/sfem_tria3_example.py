"""SFEM - Tria 3, implementation as per phungvan2013

"""
import numpy as np
import matplotlib.pyplot as plt
from scipy.sparse import coo_matrix

from meshless.composite.laminate import read_stack
from meshless.sparse import solve


XGLOBAL = np.array([1., 0, 0])
YGLOBAL = np.array([0, 1., 0])
ZGLOBAL = np.array([0, 0, 1.])


def area_of_polygon(x, y):
    """Area of an arbitrary 2D polygon given its verticies
    """
    area = 0.0
    for i in range(-1, len(x)-1):
        area += x[i] * (y[i+1] - y[i-1])
    return abs(area) / 2.0


def unitvec(vector):
    """Return the unit vector
    """
    return vector / np.linalg.norm(vector)


class Property(object):
    def __init__(self, A, B, D, E):
        self.A = A
        self.B = B
        self.D = D
        self.E = E


class IntegrationPoint(object):
    def __init__(self, tria, n1, n2, n3, f1, f2, f3, nx, ny, nz, le):
        self.pos = (f1*n1 + f2*n2 + f3*n3).pos
        self.tria = tria
        self.n1 = n1
        self.n2 = n2
        self.n3 = n3
        self.f1 = f1
        self.f2 = f2
        self.f3 = f3
        self.nx = nx
        self.ny = ny
        self.nz = nz # 3D case
        self.le = le # length of the line where the integration point lies on


class Tria(object):
    def __init__(self, n1, n2, n3):
        self.n1 = n1
        self.n2 = n2
        self.n3 = n3
        self.nodes = [n1, n2, n3]
        #NOTE perhaps not needed
        self.A = area_of_polygon([n1.pos[0], n2.pos[0], n3.pos[0]],
                                  [n1.pos[1], n2.pos[1], n3.pos[1]])
        self.prop = None # either define here or in Node


    def getMid(self):
        return 1/3*(self.n1 + self.n2 + self.n3)


class Edge(object):
    def __init__(self, n1, n2):
        self.n1 = n1
        self.n2 = n2
        self.nodes = [n1, n2]
        self.trias = []
        self.sdomain = []
        self.ipts = []
        self.Ac = None

    def getMid(self):
        return 0.5*(self.n1 + self.n2)


class Node(object):
    def __init__(self, x, y, z):
        self.pos = np.array([x, y, z], dtype=float)
        self.trias = set()
        self.sdomain = None
        self.index = None
        self.prop = None # either define here or in Tria

    def __add__(self, val):
        if isinstance(val, Node):
            return Node(*(self.pos + val.pos))
        else:
            return Node(*(self.pos + val))

    def __sub__(self, val):
        if isinstance(val, Node):
            return Node(*(self.pos - val.pos))
        else:
            return Node(*(self.pos - val))

    def __rmul__(self, val):
        if isinstance(val, Node):
            return Node(*(self.pos * val.pos))
        else:
            return Node(*(self.pos * val))

    def __lmul__(self, val):
        return self.__rmul__(val)

a = 7.
b = 2.


plt.figure(dpi=300)

nodes = np.array([
        Node(0, 0, 0),
        Node(a/3, 0, 0),
        Node(2*a/3, 0, 0),
        Node(a, 0, 0),

        Node(0, b/3, 0),
        Node(a/3, b/3, 0),
        Node(2*a/3, b/3, 0),
        Node(a, b/3, 0),

        Node(0, 2*b/3, 0),
        Node(a/3, 2*b/3, 0),
        Node(2*a/3, 2*b/3, 0),
        Node(a, 2*b/3, 0),

        Node(0, b, 0),
        Node(a/3, b, 0),
        Node(2*a/3, b, 0),
        Node(a, b, 0),
        ])

trias = [
        Tria(nodes[0], nodes[1], nodes[5]),
        Tria(nodes[1], nodes[2], nodes[6]),
        Tria(nodes[2], nodes[3], nodes[7]),
        Tria(nodes[0], nodes[5], nodes[4]),
        Tria(nodes[1], nodes[6], nodes[5]),
        Tria(nodes[2], nodes[7], nodes[6]),

        Tria(nodes[4], nodes[5], nodes[9]),
        Tria(nodes[5], nodes[6], nodes[10]),
        Tria(nodes[6], nodes[7], nodes[11]),
        Tria(nodes[4], nodes[9], nodes[8]),
        Tria(nodes[5], nodes[10], nodes[9]),
        Tria(nodes[6], nodes[11], nodes[10]),

        Tria(nodes[8], nodes[9], nodes[13]),
        Tria(nodes[9], nodes[10], nodes[14]),
        Tria(nodes[10], nodes[11], nodes[15]),
        Tria(nodes[8], nodes[13], nodes[12]),
        Tria(nodes[9], nodes[14], nodes[13]),
        Tria(nodes[10], nodes[15], nodes[14]),
       ]

# __________________________________________________________________
#
# the code above will come from an external triangulation algorithm
# __________________________________________________________________
#
#  FOCUS HERE AND BELOW
# __________________________________________________________________

xcord = [node.pos[0] for node in nodes]
ycord = [node.pos[1] for node in nodes]
plt.scatter(xcord, ycord)
plt.gca().set_aspect('equal')

# ASSEMBLYING GLOBAL MATRICES

# renumbering nodes using Liu's suggested algorithm
# - sorting nodes from a minimum spatial position to a maximum one
# - Node oject will carry an index that will position it in the global
#   stiffness matrix
nodes_xyz = np.array([n.pos for n in nodes])
index_ref_point = nodes_xyz.min(axis=0)

index_dist = ((nodes_xyz - index_ref_point)**2).sum(axis=-1)
indices = np.argsort(index_dist)
ind2node = {}
for i, node in enumerate(nodes):
    node.index = i
    #node.index = indices[i]
    #ind2node[node.index] = node

n = nodes.shape[0]
dof = 5

# material properties
E11 = 71.e9
nu = 0.33
plyt = 0.01
lam = read_stack([0], plyt=plyt, laminaprop=(E11, E11, nu))
prop = Property(lam.A, lam.B, lam.D, lam.E)
for tria in trias:
    tria.prop = prop

#TODO allocate less memory here...
k0 = np.zeros((n*dof, n*dof), dtype=np.float64)

prop_from_node = False
count = 0
Atotal = 0

for tria in trias:
    Ac = tria.A
    if prop_from_node:
        raise
        #A = f1*ipt.n1.prop.A + f2*ipt.n2.prop.A + f3*ipt.n3.prop.A
        #B = f1*ipt.n1.prop.B + f2*ipt.n2.prop.B + f3*ipt.n3.prop.B
        #D = f1*ipt.n1.prop.D + f2*ipt.n2.prop.D + f3*ipt.n3.prop.D
        #E = f1*ipt.n1.prop.E + f2*ipt.n2.prop.E + f3*ipt.n3.prop.E
    else:
        A = tria.prop.A
        B = tria.prop.B
        D = tria.prop.D

    A11 = A[0, 0]
    A12 = A[0, 1]
    A16 = A[0, 2]
    A22 = A[1, 1]
    A26 = A[1, 2]
    A66 = A[2, 2]
    B11 = B[0, 0]
    B12 = B[0, 1]
    B16 = B[0, 2]
    B22 = B[1, 1]
    B26 = B[1, 2]
    B66 = B[2, 2]
    D11 = D[0, 0]
    D12 = D[0, 1]
    D16 = D[0, 2]
    D22 = D[1, 1]
    D26 = D[1, 2]
    D66 = D[2, 2]

    #TODO interpolate nodal properties when used
    if prop_from_node:
        raise NotImplementedError('')
    k = 5/6 #TODO!!!

    E = k * tria.prop.E
    E44 = E[0, 0]
    E45 = E[0, 1]
    E55 = E[1, 1]


    n1, n2, n3 = tria.nodes
    mid = tria.getMid()

    if np.dot(np.cross((n1 - mid).pos, (n2 - mid).pos), ZGLOBAL) < 0:
        n1, n2, n3 = n2, n1, n3

    #TODO calculate triangle area here, in case nodes coordinate are updated
    #     during solution
    Ac = tria.A

    # sub-tria 1
    x1, y1, z1 = mid.pos
    x2, y2, z2 = n2.pos
    x3, y3, z3 = n3.pos
    a1 = x2 - x1
    b1 = y2 - y1
    c1 = y3 - y1
    d1 = x3 - x1

    tmp = [mid, n2, n3]
    Ac1 = area_of_polygon([n.pos[0] for n in tmp], [n.pos[1] for n in tmp])

    # sub-tria 2
    x1, y1, z1 = n1.pos
    x2, y2, z2 = mid.pos
    x3, y3, z3 = n3.pos
    a2 = x2 - x1
    b2 = y2 - y1
    c2 = y3 - y1
    d2 = x3 - x1

    tmp = [n1, mid, n3]
    Ac2 = area_of_polygon([n.pos[0] for n in tmp], [n.pos[1] for n in tmp])

    # sub-tria 3
    x1, y1, z1 = n1.pos
    x2, y2, z2 = n2.pos
    x3, y3, z3 = mid.pos
    a3 = x2 - x1
    b3 = y2 - y1
    c3 = y3 - y1
    d3 = x3 - x1

    tmp = [n1, n2, mid]
    Ac3 = area_of_polygon([n.pos[0] for n in tmp], [n.pos[1] for n in tmp])

    i1 = n1.index
    i2 = n2.index
    i3 = n3.index

    k0[i1*dof+0, i1*dof+0] += Ac*((A11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + A16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (A16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + A66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i1*dof+0, i1*dof+1] += Ac*((A12*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + A26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + (A16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + A66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i1*dof+0, i1*dof+3] += Ac*((B11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i1*dof+0, i1*dof+4] += Ac*(-0.166666666666667*d2*(B11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)/Ac + (B12*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + (B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i1*dof+0, i2*dof+0] += Ac*((A11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + A16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (A16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + A66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i1*dof+0, i2*dof+1] += Ac*((A12*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + A26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + (A16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + A66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i1*dof+0, i2*dof+3] += Ac*((B11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i1*dof+0, i2*dof+4] += Ac*((B11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + (B12*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i1*dof+0, i3*dof+0] += Ac*((A11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + A16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (A16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + A66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i1*dof+0, i3*dof+1] += Ac*((A12*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + A26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + (A16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + A66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i1*dof+0, i3*dof+3] += Ac*((B11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i1*dof+0, i3*dof+4] += Ac*(-0.166666666666667*d2*(B11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)/Ac + (B12*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i1*dof+1, i1*dof+0] += Ac*((A12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + A16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (A26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + A66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i1*dof+1, i1*dof+1] += Ac*((A22*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + A26*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + (A26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + A66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i1*dof+1, i1*dof+3] += Ac*((B12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + B66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i1*dof+1, i1*dof+4] += Ac*(-0.166666666666667*d2*(B12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)/Ac + (B22*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + B26*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + (B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + B66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i1*dof+1, i2*dof+0] += Ac*((A12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + A16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (A26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + A66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i1*dof+1, i2*dof+1] += Ac*((A22*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + A26*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + (A26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + A66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i1*dof+1, i2*dof+3] += Ac*((B12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + B66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i1*dof+1, i2*dof+4] += Ac*((B12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + (B22*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + B26*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + B66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i1*dof+1, i3*dof+0] += Ac*((A12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + A16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (A26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + A66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i1*dof+1, i3*dof+1] += Ac*((A22*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + A26*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + (A26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + A66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i1*dof+1, i3*dof+3] += Ac*((B12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + B66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i1*dof+1, i3*dof+4] += Ac*(-0.166666666666667*d2*(B12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)/Ac + (B22*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + B26*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + B66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i1*dof+2, i1*dof+2] += Ac*((E44*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E45*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (E45*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E55*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i1*dof+2, i1*dof+3] += Ac*((-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)*(E45*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E55*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)/Ac + (E44*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E45*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac)
    k0[i1*dof+2, i1*dof+4] += Ac*((0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)*(E44*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E45*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)/Ac + (E45*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E55*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)
    k0[i1*dof+2, i2*dof+2] += Ac*((E44*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E45*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (E45*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E55*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i1*dof+2, i2*dof+3] += Ac*((E44*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E45*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E55*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)
    k0[i1*dof+2, i2*dof+4] += Ac*((E44*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E45*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + (E45*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E55*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)
    k0[i1*dof+2, i3*dof+2] += Ac*((E44*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E45*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (E45*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E55*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i1*dof+2, i3*dof+3] += Ac*((E44*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E45*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E55*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)
    k0[i1*dof+2, i3*dof+4] += Ac*((E44*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E45*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + (E45*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + E55*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)
    k0[i1*dof+3, i1*dof+0] += Ac*((B11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i1*dof+3, i1*dof+1] += Ac*((B12*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + (B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i1*dof+3, i1*dof+2] += Ac*((E44*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E45*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E55*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i1*dof+3, i1*dof+3] += Ac*((-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)*(E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E55*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)/Ac + (D11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + D16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (D16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + D66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + (E44*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E45*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac)
    k0[i1*dof+3, i1*dof+4] += Ac*(-0.166666666666667*d2*(D11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + D16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)/Ac + (0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)*(E44*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E45*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)/Ac + (D12*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + D26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + (D16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + D66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E55*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)
    k0[i1*dof+3, i2*dof+0] += Ac*((B11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i1*dof+3, i2*dof+1] += Ac*((B12*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + (B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i1*dof+3, i2*dof+2] += Ac*((E44*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E45*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E55*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i1*dof+3, i2*dof+3] += Ac*((D11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + D16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (D16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + D66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + (E44*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E45*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E55*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)
    k0[i1*dof+3, i2*dof+4] += Ac*((D11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + D16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + (D12*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + D26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (D16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + D66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (E44*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E45*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + (E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E55*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)
    k0[i1*dof+3, i3*dof+0] += Ac*((B11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i1*dof+3, i3*dof+1] += Ac*((B12*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + (B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + B66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i1*dof+3, i3*dof+2] += Ac*((E44*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E45*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E55*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i1*dof+3, i3*dof+3] += Ac*((D11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + D16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (D16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + D66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + (E44*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E45*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E55*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)
    k0[i1*dof+3, i3*dof+4] += Ac*(-0.166666666666667*d2*(D11*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + D16*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)/Ac + (D12*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + D26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (D16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + D66*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (E44*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E45*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + (E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + E55*(-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)
    k0[i1*dof+4, i1*dof+0] += Ac*((-0.166666666666667*B11*d2/Ac + B12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (-0.166666666666667*B16*d2/Ac + B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + B66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i1*dof+4, i1*dof+1] += Ac*((-0.166666666666667*B12*d2/Ac + B22*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + B26*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + (-0.166666666666667*B16*d2/Ac + B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + B66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i1*dof+4, i1*dof+2] += Ac*((E44*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (E45*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i1*dof+4, i1*dof+3] += Ac*((-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)*(E45*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)/Ac + (E44*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + (-0.166666666666667*D11*d2/Ac + D12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + D16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (-0.166666666666667*D16*d2/Ac + D26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + D66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i1*dof+4, i1*dof+4] += Ac*(-0.166666666666667*d2*(-0.166666666666667*D11*d2/Ac + D12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + D16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)/Ac + (0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)*(E44*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)/Ac + (E45*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac + (-0.166666666666667*D12*d2/Ac + D22*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + D26*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + (-0.166666666666667*D16*d2/Ac + D26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + D66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i1*dof+4, i2*dof+0] += Ac*((-0.166666666666667*B11*d2/Ac + B12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (-0.166666666666667*B16*d2/Ac + B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + B66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i1*dof+4, i2*dof+1] += Ac*((-0.166666666666667*B12*d2/Ac + B22*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + B26*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + (-0.166666666666667*B16*d2/Ac + B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + B66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i1*dof+4, i2*dof+2] += Ac*((E44*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (E45*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i1*dof+4, i2*dof+3] += Ac*((E44*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac + (-0.166666666666667*D11*d2/Ac + D12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + D16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (-0.166666666666667*D16*d2/Ac + D26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + D66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i1*dof+4, i2*dof+4] += Ac*((E44*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + (E45*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac + (-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)*(-0.166666666666667*D12*d2/Ac + D22*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + D26*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)/Ac + (-d1/2 - 0.166666666666667*d2 - d3/2)*(-0.166666666666667*D11*d2/Ac + D12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + D16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)/Ac + (-0.166666666666667*D16*d2/Ac + D26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + D66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i1*dof+4, i3*dof+0] += Ac*((-0.166666666666667*B11*d2/Ac + B12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + B16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (-0.166666666666667*B16*d2/Ac + B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + B66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i1*dof+4, i3*dof+1] += Ac*((-0.166666666666667*B12*d2/Ac + B22*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + B26*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + (-0.166666666666667*B16*d2/Ac + B26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + B66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i1*dof+4, i3*dof+2] += Ac*((E44*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (E45*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i1*dof+4, i3*dof+3] += Ac*((E44*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac + (-0.166666666666667*D11*d2/Ac + D12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + D16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (-0.166666666666667*D16*d2/Ac + D26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + D66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i1*dof+4, i3*dof+4] += Ac*(-0.166666666666667*d2*(-0.166666666666667*D11*d2/Ac + D12*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + D16*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)/Ac + (E44*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + (E45*(0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac + (-0.166666666666667*D12*d2/Ac + D22*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + D26*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (-0.166666666666667*D16*d2/Ac + D26*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + D66*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i2*dof+0, i1*dof+0] += Ac*((A11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + A16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (A16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + A66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i2*dof+0, i1*dof+1] += Ac*((A12*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + A26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + (A16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + A66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i2*dof+0, i1*dof+3] += Ac*((B11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i2*dof+0, i1*dof+4] += Ac*(-0.166666666666667*d2*(B11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)/Ac + (B12*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + (B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i2*dof+0, i2*dof+0] += Ac*((A11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + A16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (A16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + A66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i2*dof+0, i2*dof+1] += Ac*((A12*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + A26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + (A16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + A66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i2*dof+0, i2*dof+3] += Ac*((B11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i2*dof+0, i2*dof+4] += Ac*((B11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + (B12*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i2*dof+0, i3*dof+0] += Ac*((A11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + A16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (A16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + A66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i2*dof+0, i3*dof+1] += Ac*((A12*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + A26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + (A16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + A66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i2*dof+0, i3*dof+3] += Ac*((B11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i2*dof+0, i3*dof+4] += Ac*(-0.166666666666667*d2*(B11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)/Ac + (B12*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i2*dof+1, i1*dof+0] += Ac*((A12*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + A16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (A26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + A66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i2*dof+1, i1*dof+1] += Ac*((A22*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + A26*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + (A26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + A66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i2*dof+1, i1*dof+3] += Ac*((B12*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (B26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + B66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i2*dof+1, i1*dof+4] += Ac*(-0.166666666666667*d2*(B12*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)/Ac + (B22*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + B26*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + (B26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + B66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i2*dof+1, i2*dof+0] += Ac*((A12*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + A16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (A26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + A66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i2*dof+1, i2*dof+1] += Ac*((A22*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + A26*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + (A26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + A66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i2*dof+1, i2*dof+3] += Ac*((B12*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (B26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + B66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i2*dof+1, i2*dof+4] += Ac*((B12*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + (B22*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + B26*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (B26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + B66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i2*dof+1, i3*dof+0] += Ac*((A12*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + A16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (A26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + A66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i2*dof+1, i3*dof+1] += Ac*((A22*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + A26*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + (A26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + A66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i2*dof+1, i3*dof+3] += Ac*((B12*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (B26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + B66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i2*dof+1, i3*dof+4] += Ac*(-0.166666666666667*d2*(B12*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)/Ac + (B22*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + B26*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (B26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + B66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i2*dof+2, i1*dof+2] += Ac*((E44*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E45*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (E45*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E55*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i2*dof+2, i1*dof+3] += Ac*((-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)*(E45*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E55*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)/Ac + (E44*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E45*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac)
    k0[i2*dof+2, i1*dof+4] += Ac*((0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)*(E44*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E45*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)/Ac + (E45*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E55*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)
    k0[i2*dof+2, i2*dof+2] += Ac*((E44*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E45*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (E45*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E55*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i2*dof+2, i2*dof+3] += Ac*((E44*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E45*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E55*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)
    k0[i2*dof+2, i2*dof+4] += Ac*((E44*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E45*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + (E45*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E55*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)
    k0[i2*dof+2, i3*dof+2] += Ac*((E44*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E45*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (E45*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E55*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i2*dof+2, i3*dof+3] += Ac*((E44*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E45*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E55*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)
    k0[i2*dof+2, i3*dof+4] += Ac*((E44*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E45*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + (E45*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + E55*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)
    k0[i2*dof+3, i1*dof+0] += Ac*((B11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i2*dof+3, i1*dof+1] += Ac*((B12*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + (B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i2*dof+3, i1*dof+2] += Ac*((E44*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E45*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (E45*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E55*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i2*dof+3, i1*dof+3] += Ac*((-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)*(E45*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E55*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)/Ac + (D11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + D16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (D16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + D66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + (E44*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E45*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac)
    k0[i2*dof+3, i1*dof+4] += Ac*(-0.166666666666667*d2*(D11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + D16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)/Ac + (0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)*(E44*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E45*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)/Ac + (D12*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + D26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + (D16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + D66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (E45*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E55*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)
    k0[i2*dof+3, i2*dof+0] += Ac*((B11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i2*dof+3, i2*dof+1] += Ac*((B12*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + (B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i2*dof+3, i2*dof+2] += Ac*((E44*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E45*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (E45*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E55*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i2*dof+3, i2*dof+3] += Ac*((D11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + D16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (D16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + D66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + (E44*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E45*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E55*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)
    k0[i2*dof+3, i2*dof+4] += Ac*((D11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + D16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + (D12*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + D26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (D16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + D66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (E44*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E45*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + (E45*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E55*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)
    k0[i2*dof+3, i3*dof+0] += Ac*((B11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i2*dof+3, i3*dof+1] += Ac*((B12*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + (B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + B66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i2*dof+3, i3*dof+2] += Ac*((E44*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E45*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (E45*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E55*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i2*dof+3, i3*dof+3] += Ac*((D11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + D16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (D16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + D66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + (E44*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E45*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E55*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)
    k0[i2*dof+3, i3*dof+4] += Ac*(-0.166666666666667*d2*(D11*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + D16*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)/Ac + (D12*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + D26*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (D16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + D66*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (E44*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E45*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + (E45*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + E55*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)
    k0[i2*dof+4, i1*dof+0] += Ac*((B11*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + B12*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (B16*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + B26*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i2*dof+4, i1*dof+1] += Ac*((B12*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + B22*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B26*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + (B16*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + B26*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i2*dof+4, i1*dof+2] += Ac*((E44*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (E45*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i2*dof+4, i1*dof+3] += Ac*((-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)*(E45*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)/Ac + (E44*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + (D11*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + D12*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (D16*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + D26*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i2*dof+4, i1*dof+4] += Ac*(-0.166666666666667*d2*(D11*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + D12*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)/Ac + (0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)*(E44*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)/Ac + (E45*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac + (D12*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + D22*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D26*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + (D16*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + D26*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i2*dof+4, i2*dof+0] += Ac*((B11*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + B12*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (B16*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + B26*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i2*dof+4, i2*dof+1] += Ac*((B12*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + B22*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B26*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + (B16*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + B26*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i2*dof+4, i2*dof+2] += Ac*((E44*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (E45*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i2*dof+4, i2*dof+3] += Ac*((E44*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac + (D11*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + D12*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (D16*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + D26*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i2*dof+4, i2*dof+4] += Ac*((E44*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + (E45*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac + (-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)*(D12*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + D22*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D26*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)/Ac + (-d1/2 - 0.166666666666667*d2 - d3/2)*(D11*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + D12*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)/Ac + (D16*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + D26*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i2*dof+4, i3*dof+0] += Ac*((B11*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + B12*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (B16*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + B26*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i2*dof+4, i3*dof+1] += Ac*((B12*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + B22*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B26*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + (B16*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + B26*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i2*dof+4, i3*dof+2] += Ac*((E44*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (E45*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i2*dof+4, i3*dof+3] += Ac*((E44*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac + (D11*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + D12*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (D16*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + D26*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i2*dof+4, i3*dof+4] += Ac*(-0.166666666666667*d2*(D11*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + D12*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D16*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)/Ac + (E44*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + (E45*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac + (D12*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + D22*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D26*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (D16*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + D26*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D66*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i3*dof+0, i1*dof+0] += Ac*((A11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + A16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (A16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + A66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i3*dof+0, i1*dof+1] += Ac*((A12*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + A26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + (A16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + A66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i3*dof+0, i1*dof+3] += Ac*((B11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i3*dof+0, i1*dof+4] += Ac*(-0.166666666666667*d2*(B11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)/Ac + (B12*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + (B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i3*dof+0, i2*dof+0] += Ac*((A11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + A16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (A16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + A66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i3*dof+0, i2*dof+1] += Ac*((A12*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + A26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + (A16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + A66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i3*dof+0, i2*dof+3] += Ac*((B11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i3*dof+0, i2*dof+4] += Ac*((B11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + (B12*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i3*dof+0, i3*dof+0] += Ac*((A11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + A16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (A16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + A66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i3*dof+0, i3*dof+1] += Ac*((A12*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + A26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + (A16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + A66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i3*dof+0, i3*dof+3] += Ac*((B11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i3*dof+0, i3*dof+4] += Ac*(-0.166666666666667*d2*(B11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)/Ac + (B12*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i3*dof+1, i1*dof+0] += Ac*((A12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + A16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (A26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + A66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i3*dof+1, i1*dof+1] += Ac*((A22*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + A26*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + (A26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + A66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i3*dof+1, i1*dof+3] += Ac*((B12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + B66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i3*dof+1, i1*dof+4] += Ac*(-0.166666666666667*d2*(B12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)/Ac + (B22*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + B26*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + (B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + B66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i3*dof+1, i2*dof+0] += Ac*((A12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + A16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (A26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + A66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i3*dof+1, i2*dof+1] += Ac*((A22*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + A26*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + (A26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + A66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i3*dof+1, i2*dof+3] += Ac*((B12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + B66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i3*dof+1, i2*dof+4] += Ac*((B12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + (B22*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + B26*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + B66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i3*dof+1, i3*dof+0] += Ac*((A12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + A16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (A26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + A66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i3*dof+1, i3*dof+1] += Ac*((A22*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + A26*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + (A26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + A66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i3*dof+1, i3*dof+3] += Ac*((B12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + B66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i3*dof+1, i3*dof+4] += Ac*(-0.166666666666667*d2*(B12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)/Ac + (B22*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + B26*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + B66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i3*dof+2, i1*dof+2] += Ac*((E44*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E45*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (E45*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E55*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i3*dof+2, i1*dof+3] += Ac*((-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)*(E45*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E55*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)/Ac + (E44*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E45*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac)
    k0[i3*dof+2, i1*dof+4] += Ac*((0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)*(E44*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E45*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)/Ac + (E45*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E55*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)
    k0[i3*dof+2, i2*dof+2] += Ac*((E44*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E45*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (E45*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E55*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i3*dof+2, i2*dof+3] += Ac*((E44*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E45*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E55*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)
    k0[i3*dof+2, i2*dof+4] += Ac*((E44*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E45*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + (E45*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E55*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)
    k0[i3*dof+2, i3*dof+2] += Ac*((E44*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E45*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (E45*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E55*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i3*dof+2, i3*dof+3] += Ac*((E44*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E45*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E55*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)
    k0[i3*dof+2, i3*dof+4] += Ac*((E44*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E45*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + (E45*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + E55*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)
    k0[i3*dof+3, i1*dof+0] += Ac*((B11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i3*dof+3, i1*dof+1] += Ac*((B12*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + (B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i3*dof+3, i1*dof+2] += Ac*((E44*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E45*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (E45*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E55*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i3*dof+3, i1*dof+3] += Ac*((-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)*(E45*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E55*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)/Ac + (D11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + D16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (D16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + D66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + (E44*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E45*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac)
    k0[i3*dof+3, i1*dof+4] += Ac*(-0.166666666666667*d2*(D11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + D16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)/Ac + (0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)*(E44*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E45*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)/Ac + (D12*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + D26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + (D16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + D66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (E45*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E55*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)
    k0[i3*dof+3, i2*dof+0] += Ac*((B11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i3*dof+3, i2*dof+1] += Ac*((B12*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + (B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i3*dof+3, i2*dof+2] += Ac*((E44*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E45*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (E45*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E55*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i3*dof+3, i2*dof+3] += Ac*((D11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + D16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (D16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + D66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + (E44*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E45*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E55*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac)
    k0[i3*dof+3, i2*dof+4] += Ac*((D11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + D16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-d1/2 - 0.166666666666667*d2 - d3/2)/Ac + (D12*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + D26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (D16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + D66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (E44*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E45*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + (E45*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E55*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac)
    k0[i3*dof+3, i3*dof+0] += Ac*((B11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i3*dof+3, i3*dof+1] += Ac*((B12*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + (B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + B66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i3*dof+3, i3*dof+2] += Ac*((E44*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E45*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (E45*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E55*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i3*dof+3, i3*dof+3] += Ac*((D11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + D16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (D16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + D66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + (E44*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E45*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E55*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)
    k0[i3*dof+3, i3*dof+4] += Ac*(-0.166666666666667*d2*(D11*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + D16*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)/Ac + (D12*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + D26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (D16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + D66*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (E44*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E45*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + (E45*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + E55*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)
    k0[i3*dof+4, i1*dof+0] += Ac*((-0.166666666666667*B11*d2/Ac + B12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (-0.166666666666667*B16*d2/Ac + B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i3*dof+4, i1*dof+1] += Ac*((-0.166666666666667*B12*d2/Ac + B22*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B26*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac + (-0.166666666666667*B16*d2/Ac + B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i3*dof+4, i1*dof+2] += Ac*((E44*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (E45*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i3*dof+4, i1*dof+3] += Ac*((-0.0833333333333333*a2*d2 + 0.0833333333333333*a3*d3)*(E45*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)/Ac + (E44*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a2*c2 - 0.0833333333333333*b3*d3)/Ac + (-0.166666666666667*D11*d2/Ac + D12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac + (-0.166666666666667*D16*d2/Ac + D26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + 0.333333333333333*d2 + d3/2)/Ac)
    k0[i3*dof+4, i1*dof+4] += Ac*(-0.166666666666667*d2*(-0.166666666666667*D11*d2/Ac + D12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)/Ac + (0.0833333333333333*b2*c2 - 0.0833333333333333*b3*c3)*(E44*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)/Ac + (E45*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*Ac1 + Ac2/2 + Ac3/2 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac + (-0.166666666666667*D12*d2/Ac + D22*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D26*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.166666666666667*a1 - a2/2 - 0.333333333333333*a3 + 0.166666666666667*d1 + d2/2 + d3/2)/Ac + (-0.166666666666667*D16*d2/Ac + D26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 + b2/2 + 0.333333333333333*b3 - 0.166666666666667*c1 - 0.333333333333333*c2 - c3/2)/Ac)
    k0[i3*dof+4, i2*dof+0] += Ac*((-0.166666666666667*B11*d2/Ac + B12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (-0.166666666666667*B16*d2/Ac + B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i3*dof+4, i2*dof+1] += Ac*((-0.166666666666667*B12*d2/Ac + B22*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B26*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac + (-0.166666666666667*B16*d2/Ac + B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i3*dof+4, i2*dof+2] += Ac*((E44*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (E45*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i3*dof+4, i2*dof+3] += Ac*((E44*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + 0.0833333333333333*a2*c2 + a3*c3/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(-a1*d1/4 - 0.0833333333333333*a2*d2 - 0.166666666666667*a3*d3)/Ac + (-0.166666666666667*D11*d2/Ac + D12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac + (-0.166666666666667*D16*d2/Ac + D26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.166666666666667*a1 + 0.166666666666667*a3 - 0.333333333333333*d1 - 0.166666666666667*d2 - d3/2)/Ac)
    k0[i3*dof+4, i2*dof+4] += Ac*((E44*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(b1*c1/4 + 0.0833333333333333*b2*c2 + 0.166666666666667*b3*c3)/Ac + (E45*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a3*c3 - b1*d1/4 - 0.0833333333333333*b2*d2 - b3*d3/4)/Ac + (-0.166666666666667*a1 + 0.166666666666667*a3 + 0.166666666666667*d1)*(-0.166666666666667*D12*d2/Ac + D22*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D26*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)/Ac + (-d1/2 - 0.166666666666667*d2 - d3/2)*(-0.166666666666667*D11*d2/Ac + D12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)/Ac + (-0.166666666666667*D16*d2/Ac + D26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.166666666666667*b1 - 0.166666666666667*b3 + 0.333333333333333*c1 + 0.166666666666667*c2 + c3/2)/Ac)
    k0[i3*dof+4, i3*dof+0] += Ac*((-0.166666666666667*B11*d2/Ac + B12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (-0.166666666666667*B16*d2/Ac + B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i3*dof+4, i3*dof+1] += Ac*((-0.166666666666667*B12*d2/Ac + B22*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B26*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac + (-0.166666666666667*B16*d2/Ac + B26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + B66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)
    k0[i3*dof+4, i3*dof+2] += Ac*((E44*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (E45*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i3*dof+4, i3*dof+3] += Ac*((E44*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*Ac1 + 0.0833333333333333*a2*c2 - b1*d1/4 - b2*d2/4 - 0.0833333333333333*b3*d3)/Ac + (E45*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(a1*d1/4 + 0.166666666666667*a2*d2 + 0.0833333333333333*a3*d3)/Ac + (-0.166666666666667*D11*d2/Ac + D12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac + (-0.166666666666667*D16*d2/Ac + D26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1 - 0.166666666666667*d2)/Ac)
    k0[i3*dof+4, i3*dof+4] += Ac*(-0.166666666666667*d2*(-0.166666666666667*D11*d2/Ac + D12*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D16*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)/Ac + (E44*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E45*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + (E45*(-b1*c1/4 - 0.166666666666667*b2*c2 - 0.0833333333333333*b3*c3)/Ac + E55*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac)*(0.166666666666667*Ac1 + a1*c1/4 + a2*c2/4 + 0.0833333333333333*a3*c3 - 0.0833333333333333*b2*d2)/Ac + (-0.166666666666667*D12*d2/Ac + D22*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D26*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + (-0.166666666666667*D16*d2/Ac + D26*(0.333333333333333*a1 + a2/2 + 0.166666666666667*a3 + 0.166666666666667*d1)/Ac + D66*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)*(-0.333333333333333*b1 - b2/2 - 0.166666666666667*b3 - 0.166666666666667*c1 + 0.166666666666667*c2)/Ac)

print('Atotal:', Atotal)

puvw = 2
for subcase in (1, 3):
    if subcase == 1:
        print('SUBCASE %d' % subcase)
        k0run = k0.copy()

        # force vector
        fext = np.zeros(n*dof, dtype=np.float64)
        fext[nodes[3].index*dof + puvw] = 500.
        fext[nodes[7].index*dof + puvw] = 1000.
        fext[nodes[11].index*dof + puvw] = 1000.
        fext[nodes[15].index*dof + puvw] = 500.

        i, j = np.indices(k0run.shape)
        #k0run[i, j] = k0run[j, i]
        print('symmetry check 1:', np.abs(k0run[i, j] - k0run[j, i]).max())
        print('symmetry check 2:', k0run[i>j].sum(), k0run[i<j].sum())

        # boundary conditions
        for i in [0, 4, 8, 12]:
            for j in [0, 1, 2, 3]:
                k0run[nodes[i].index*dof+j, :] = 0
                k0run[:, nodes[i].index*dof+j] = 0

        k0run = coo_matrix(k0run)
        u = solve(k0run, fext, silent=True)

        xcord = np.array([node.pos[0] for node in nodes])
        ycord = np.array([node.pos[1] for node in nodes])
        wmin = u[puvw::dof].min()
        wmax = u[puvw::dof].max()
        levels = np.linspace(wmin, wmax, 400)
        print(u[puvw::dof].reshape(4, 4))


    elif subcase == 3:
        print('SUBCASE %d' % subcase)
        k0run = k0.copy()
        # force vector
        fext = np.zeros(n*dof, dtype=np.float64)
        fext[nodes[14].index*dof + puvw] = -1000.
        fext[nodes[2].index*dof + puvw] = 1000.

        # boundary conditions
        for i in [0, 4, 8, 12]:
            for j in [0, 1, 2, 3]:
                k0run[nodes[i].index*dof+j, :] = 0
                k0run[:, nodes[i].index*dof+j] = 0
        for i in [3, 7, 11, 15]:
            for j in [0, 1, 2]:
                k0run[nodes[i].index*dof+j, :] = 0
                k0run[:, nodes[i].index*dof+j] = 0

        k0run = coo_matrix(k0run)
        u = solve(k0run, fext, silent=True)

        xcord = np.array([node.pos[0] for node in nodes])
        ycord = np.array([node.pos[1] for node in nodes])
        wmin = u[puvw::dof].min()
        wmax = u[puvw::dof].max()
        levels = np.linspace(wmin, wmax, 400)
        print(u[puvw::dof].reshape(4, 4))



        plt.contourf(xcord.reshape(4, 4), ycord.reshape(4, 4), u[puvw::dof].reshape(4, 4),
                levels=levels)

        plt.savefig('plot_sfem_tria3_example.png', bbox_inches='tight')
