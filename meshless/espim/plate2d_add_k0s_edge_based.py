from __future__ import absolute_import, division

import numpy as np

from ..logger import msg
from ..constants import ZGLOBAL
from .plate2d import area_of_polygon
from .read_mesh import getMid

dof = 5

def boundary_edge_tria1_n1mid1n2(k0, edge, prop_from_node):
    # tria1: n1 -> mid1 -> n2
    tria1 = edge.trias[0]
    mid1 = getMid(tria1)
    n1 = edge.n1
    n2 = edge.n2

    Ac = edge.Ac
    i1 = n1.index
    i2 = n2.index
    i3 = edge.othernode1.index

    tmp = np.array([n1.xyz, mid1, n2.xyz])
    Ac1 = area_of_polygon(tmp[:, 0], tmp[:, 1])
    x1, y1, z1 = n1.xyz
    x2, y2, z2 = mid1
    x3, y3, z3 = n2.xyz
    a1 = x2 - x1
    b1 = y2 - y1
    c1 = x3 - x1
    d1 = y3 - y1

    k = 5/6
    if prop_from_node:
        pn1 = n1.prop
        pn2 = n2.prop
        po1 = edge.othernode1.prop
        E = k*(4/9*pn1.E + 4/9*pn2.E + 1/9*po1.E)
    else:
        prop1 = tria1.prop
        E = k*prop1.E

    E44 = E[0, 0]
    E45 = E[0, 1]
    E55 = E[1, 1]

    k0[i1*dof+2, i1*dof+2] += (-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1))*(Ac*E45*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1))) + (0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1))*(Ac*E44*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)))
    k0[i1*dof+2, i1*dof+3] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(Ac*E44*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1))) - 0.0833333333333333*a1*c1*(Ac*E45*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1
    k0[i1*dof+2, i1*dof+4] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(Ac*E45*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1))) + 0.0833333333333333*b1*d1*(Ac*E44*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1
    k0[i1*dof+2, i2*dof+2] += (a1/(2*Ac1) - 0.166666666666667*c1/Ac1)*(Ac*E45*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1))) + (-b1/(2*Ac1) + 0.166666666666667*d1/Ac1)*(Ac*E44*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)))
    k0[i1*dof+2, i2*dof+3] += (Ac*E44*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)))*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*a1*c1*(Ac*E45*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1
    k0[i1*dof+2, i2*dof+4] += (Ac*E45*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)))*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*b1*d1*(Ac*E44*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1
    k0[i1*dof+2, i3*dof+2] += -0.166666666666667*c1*(Ac*E45*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1 + 0.166666666666667*d1*(Ac*E44*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1
    k0[i1*dof+2, i3*dof+3] += -0.0833333333333333*a1*c1*(Ac*E45*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1 + 0.0833333333333333*a1*d1*(Ac*E44*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1
    k0[i1*dof+2, i3*dof+4] += -0.0833333333333333*b1*c1*(Ac*E45*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1 + 0.0833333333333333*b1*d1*(Ac*E44*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1
    k0[i1*dof+3, i1*dof+2] += (-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1))*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E55*a1*c1/Ac1) + (0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1))*(Ac*E44*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*a1*c1/Ac1)
    k0[i1*dof+3, i1*dof+3] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(Ac*E44*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*a1*c1/Ac1) - 0.0833333333333333*a1*c1*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1
    k0[i1*dof+3, i1*dof+4] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E55*a1*c1/Ac1) + 0.0833333333333333*b1*d1*(Ac*E44*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i1*dof+3, i2*dof+2] += (a1/(2*Ac1) - 0.166666666666667*c1/Ac1)*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E55*a1*c1/Ac1) + (-b1/(2*Ac1) + 0.166666666666667*d1/Ac1)*(Ac*E44*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*a1*c1/Ac1)
    k0[i1*dof+3, i2*dof+3] += (Ac*E44*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*a1*c1/Ac1)*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*a1*c1*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1
    k0[i1*dof+3, i2*dof+4] += (Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E55*a1*c1/Ac1)*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*b1*d1*(Ac*E44*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i1*dof+3, i3*dof+2] += -0.166666666666667*c1*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1 + 0.166666666666667*d1*(Ac*E44*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i1*dof+3, i3*dof+3] += -0.0833333333333333*a1*c1*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1 + 0.0833333333333333*a1*d1*(Ac*E44*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i1*dof+3, i3*dof+4] += -0.0833333333333333*b1*c1*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1 + 0.0833333333333333*b1*d1*(Ac*E44*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i1*dof+4, i1*dof+2] += (-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1))*(Ac*E55*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*b1*d1/Ac1) + (0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1))*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E44*b1*d1/Ac1)
    k0[i1*dof+4, i1*dof+3] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E44*b1*d1/Ac1) - 0.0833333333333333*a1*c1*(Ac*E55*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*b1*d1/Ac1)/Ac1
    k0[i1*dof+4, i1*dof+4] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(Ac*E55*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*b1*d1/Ac1) + 0.0833333333333333*b1*d1*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i1*dof+4, i2*dof+2] += (a1/(2*Ac1) - 0.166666666666667*c1/Ac1)*(Ac*E55*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*b1*d1/Ac1) + (-b1/(2*Ac1) + 0.166666666666667*d1/Ac1)*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E44*b1*d1/Ac1)
    k0[i1*dof+4, i2*dof+3] += (Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E44*b1*d1/Ac1)*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*a1*c1*(Ac*E55*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*b1*d1/Ac1)/Ac1
    k0[i1*dof+4, i2*dof+4] += (Ac*E55*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*b1*d1/Ac1)*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*b1*d1*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i1*dof+4, i3*dof+2] += -0.166666666666667*c1*(Ac*E55*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*b1*d1/Ac1)/Ac1 + 0.166666666666667*d1*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i1*dof+4, i3*dof+3] += -0.0833333333333333*a1*c1*(Ac*E55*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*b1*d1/Ac1)/Ac1 + 0.0833333333333333*a1*d1*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i1*dof+4, i3*dof+4] += -0.0833333333333333*b1*c1*(Ac*E55*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*b1*d1/Ac1)/Ac1 + 0.0833333333333333*b1*d1*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i2*dof+2, i1*dof+2] += (-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1))*(Ac*E45*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E55*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1)) + (0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1))*(Ac*E44*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E45*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1))
    k0[i2*dof+2, i1*dof+3] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(Ac*E44*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E45*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1)) - 0.0833333333333333*a1*c1*(Ac*E45*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E55*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1))/Ac1
    k0[i2*dof+2, i1*dof+4] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(Ac*E45*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E55*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1)) + 0.0833333333333333*b1*d1*(Ac*E44*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E45*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1))/Ac1
    k0[i2*dof+2, i2*dof+2] += (a1/(2*Ac1) - 0.166666666666667*c1/Ac1)*(Ac*E45*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E55*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1)) + (-b1/(2*Ac1) + 0.166666666666667*d1/Ac1)*(Ac*E44*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E45*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1))
    k0[i2*dof+2, i2*dof+3] += (Ac*E44*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E45*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1))*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*a1*c1*(Ac*E45*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E55*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1))/Ac1
    k0[i2*dof+2, i2*dof+4] += (Ac*E45*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E55*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1))*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*b1*d1*(Ac*E44*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E45*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1))/Ac1
    k0[i2*dof+2, i3*dof+2] += -0.166666666666667*c1*(Ac*E45*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E55*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1))/Ac1 + 0.166666666666667*d1*(Ac*E44*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E45*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1))/Ac1
    k0[i2*dof+2, i3*dof+3] += -0.0833333333333333*a1*c1*(Ac*E45*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E55*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1))/Ac1 + 0.0833333333333333*a1*d1*(Ac*E44*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E45*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1))/Ac1
    k0[i2*dof+2, i3*dof+4] += -0.0833333333333333*b1*c1*(Ac*E45*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E55*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1))/Ac1 + 0.0833333333333333*b1*d1*(Ac*E44*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac*E45*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1))/Ac1
    k0[i2*dof+3, i1*dof+2] += (-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1))*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E55*a1*c1/Ac1) + (0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1))*(Ac*E44*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*a1*c1/Ac1)
    k0[i2*dof+3, i1*dof+3] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(Ac*E44*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*a1*c1/Ac1) - 0.0833333333333333*a1*c1*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E55*a1*c1/Ac1)/Ac1
    k0[i2*dof+3, i1*dof+4] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E55*a1*c1/Ac1) + 0.0833333333333333*b1*d1*(Ac*E44*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i2*dof+3, i2*dof+2] += (a1/(2*Ac1) - 0.166666666666667*c1/Ac1)*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E55*a1*c1/Ac1) + (-b1/(2*Ac1) + 0.166666666666667*d1/Ac1)*(Ac*E44*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*a1*c1/Ac1)
    k0[i2*dof+3, i2*dof+3] += (Ac*E44*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*a1*c1/Ac1)*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*a1*c1*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E55*a1*c1/Ac1)/Ac1
    k0[i2*dof+3, i2*dof+4] += (Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E55*a1*c1/Ac1)*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*b1*d1*(Ac*E44*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i2*dof+3, i3*dof+2] += -0.166666666666667*c1*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E55*a1*c1/Ac1)/Ac1 + 0.166666666666667*d1*(Ac*E44*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i2*dof+3, i3*dof+3] += -0.0833333333333333*a1*c1*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E55*a1*c1/Ac1)/Ac1 + 0.0833333333333333*a1*d1*(Ac*E44*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i2*dof+3, i3*dof+4] += -0.0833333333333333*b1*c1*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E55*a1*c1/Ac1)/Ac1 + 0.0833333333333333*b1*d1*(Ac*E44*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i2*dof+4, i1*dof+2] += (-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1))*(Ac*E55*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*b1*d1/Ac1) + (0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1))*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E44*b1*d1/Ac1)
    k0[i2*dof+4, i1*dof+3] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E44*b1*d1/Ac1) - 0.0833333333333333*a1*c1*(Ac*E55*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*b1*d1/Ac1)/Ac1
    k0[i2*dof+4, i1*dof+4] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(Ac*E55*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*b1*d1/Ac1) + 0.0833333333333333*b1*d1*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i2*dof+4, i2*dof+2] += (a1/(2*Ac1) - 0.166666666666667*c1/Ac1)*(Ac*E55*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*b1*d1/Ac1) + (-b1/(2*Ac1) + 0.166666666666667*d1/Ac1)*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E44*b1*d1/Ac1)
    k0[i2*dof+4, i2*dof+3] += (Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E44*b1*d1/Ac1)*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*a1*c1*(Ac*E55*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*b1*d1/Ac1)/Ac1
    k0[i2*dof+4, i2*dof+4] += (Ac*E55*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*b1*d1/Ac1)*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*b1*d1*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i2*dof+4, i3*dof+2] += -0.166666666666667*c1*(Ac*E55*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*b1*d1/Ac1)/Ac1 + 0.166666666666667*d1*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i2*dof+4, i3*dof+3] += -0.0833333333333333*a1*c1*(Ac*E55*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*b1*d1/Ac1)/Ac1 + 0.0833333333333333*a1*d1*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i2*dof+4, i3*dof+4] += -0.0833333333333333*b1*c1*(Ac*E55*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*b1*d1/Ac1)/Ac1 + 0.0833333333333333*b1*d1*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i3*dof+2, i1*dof+2] += (-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1))*(0.166666666666667*Ac*E45*d1/Ac1 - 0.166666666666667*Ac*E55*c1/Ac1) + (0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1))*(0.166666666666667*Ac*E44*d1/Ac1 - 0.166666666666667*Ac*E45*c1/Ac1)
    k0[i3*dof+2, i1*dof+3] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(0.166666666666667*Ac*E44*d1/Ac1 - 0.166666666666667*Ac*E45*c1/Ac1) - 0.0833333333333333*a1*c1*(0.166666666666667*Ac*E45*d1/Ac1 - 0.166666666666667*Ac*E55*c1/Ac1)/Ac1
    k0[i3*dof+2, i1*dof+4] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(0.166666666666667*Ac*E45*d1/Ac1 - 0.166666666666667*Ac*E55*c1/Ac1) + 0.0833333333333333*b1*d1*(0.166666666666667*Ac*E44*d1/Ac1 - 0.166666666666667*Ac*E45*c1/Ac1)/Ac1
    k0[i3*dof+2, i2*dof+2] += (a1/(2*Ac1) - 0.166666666666667*c1/Ac1)*(0.166666666666667*Ac*E45*d1/Ac1 - 0.166666666666667*Ac*E55*c1/Ac1) + (-b1/(2*Ac1) + 0.166666666666667*d1/Ac1)*(0.166666666666667*Ac*E44*d1/Ac1 - 0.166666666666667*Ac*E45*c1/Ac1)
    k0[i3*dof+2, i2*dof+3] += (0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1))*(0.166666666666667*Ac*E44*d1/Ac1 - 0.166666666666667*Ac*E45*c1/Ac1) + 0.166666666666667*a1*c1*(0.166666666666667*Ac*E45*d1/Ac1 - 0.166666666666667*Ac*E55*c1/Ac1)/Ac1
    k0[i3*dof+2, i2*dof+4] += (a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1)*(0.166666666666667*Ac*E45*d1/Ac1 - 0.166666666666667*Ac*E55*c1/Ac1) - 0.166666666666667*b1*d1*(0.166666666666667*Ac*E44*d1/Ac1 - 0.166666666666667*Ac*E45*c1/Ac1)/Ac1
    k0[i3*dof+2, i3*dof+2] += -0.166666666666667*c1*(0.166666666666667*Ac*E45*d1/Ac1 - 0.166666666666667*Ac*E55*c1/Ac1)/Ac1 + 0.166666666666667*d1*(0.166666666666667*Ac*E44*d1/Ac1 - 0.166666666666667*Ac*E45*c1/Ac1)/Ac1
    k0[i3*dof+2, i3*dof+3] += -0.0833333333333333*a1*c1*(0.166666666666667*Ac*E45*d1/Ac1 - 0.166666666666667*Ac*E55*c1/Ac1)/Ac1 + 0.0833333333333333*a1*d1*(0.166666666666667*Ac*E44*d1/Ac1 - 0.166666666666667*Ac*E45*c1/Ac1)/Ac1
    k0[i3*dof+2, i3*dof+4] += -0.0833333333333333*b1*c1*(0.166666666666667*Ac*E45*d1/Ac1 - 0.166666666666667*Ac*E55*c1/Ac1)/Ac1 + 0.0833333333333333*b1*d1*(0.166666666666667*Ac*E44*d1/Ac1 - 0.166666666666667*Ac*E45*c1/Ac1)/Ac1
    k0[i3*dof+3, i1*dof+2] += (-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1))*(0.0833333333333333*Ac*E45*a1*d1/Ac1 - 0.0833333333333333*Ac*E55*a1*c1/Ac1) + (0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1))*(0.0833333333333333*Ac*E44*a1*d1/Ac1 - 0.0833333333333333*Ac*E45*a1*c1/Ac1)
    k0[i3*dof+3, i1*dof+3] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(0.0833333333333333*Ac*E44*a1*d1/Ac1 - 0.0833333333333333*Ac*E45*a1*c1/Ac1) - 0.0833333333333333*a1*c1*(0.0833333333333333*Ac*E45*a1*d1/Ac1 - 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1
    k0[i3*dof+3, i1*dof+4] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(0.0833333333333333*Ac*E45*a1*d1/Ac1 - 0.0833333333333333*Ac*E55*a1*c1/Ac1) + 0.0833333333333333*b1*d1*(0.0833333333333333*Ac*E44*a1*d1/Ac1 - 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i3*dof+3, i2*dof+2] += (a1/(2*Ac1) - 0.166666666666667*c1/Ac1)*(0.0833333333333333*Ac*E45*a1*d1/Ac1 - 0.0833333333333333*Ac*E55*a1*c1/Ac1) + (-b1/(2*Ac1) + 0.166666666666667*d1/Ac1)*(0.0833333333333333*Ac*E44*a1*d1/Ac1 - 0.0833333333333333*Ac*E45*a1*c1/Ac1)
    k0[i3*dof+3, i2*dof+3] += (0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1))*(0.0833333333333333*Ac*E44*a1*d1/Ac1 - 0.0833333333333333*Ac*E45*a1*c1/Ac1) + 0.166666666666667*a1*c1*(0.0833333333333333*Ac*E45*a1*d1/Ac1 - 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1
    k0[i3*dof+3, i2*dof+4] += (a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1)*(0.0833333333333333*Ac*E45*a1*d1/Ac1 - 0.0833333333333333*Ac*E55*a1*c1/Ac1) - 0.166666666666667*b1*d1*(0.0833333333333333*Ac*E44*a1*d1/Ac1 - 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i3*dof+3, i3*dof+2] += -0.166666666666667*c1*(0.0833333333333333*Ac*E45*a1*d1/Ac1 - 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1 + 0.166666666666667*d1*(0.0833333333333333*Ac*E44*a1*d1/Ac1 - 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i3*dof+3, i3*dof+3] += -0.0833333333333333*a1*c1*(0.0833333333333333*Ac*E45*a1*d1/Ac1 - 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1 + 0.0833333333333333*a1*d1*(0.0833333333333333*Ac*E44*a1*d1/Ac1 - 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i3*dof+3, i3*dof+4] += -0.0833333333333333*b1*c1*(0.0833333333333333*Ac*E45*a1*d1/Ac1 - 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1 + 0.0833333333333333*b1*d1*(0.0833333333333333*Ac*E44*a1*d1/Ac1 - 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i3*dof+4, i1*dof+2] += (-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1))*(0.0833333333333333*Ac*E45*b1*d1/Ac1 - 0.0833333333333333*Ac*E55*b1*c1/Ac1) + (0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1))*(0.0833333333333333*Ac*E44*b1*d1/Ac1 - 0.0833333333333333*Ac*E45*b1*c1/Ac1)
    k0[i3*dof+4, i1*dof+3] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(0.0833333333333333*Ac*E44*b1*d1/Ac1 - 0.0833333333333333*Ac*E45*b1*c1/Ac1) - 0.0833333333333333*a1*c1*(0.0833333333333333*Ac*E45*b1*d1/Ac1 - 0.0833333333333333*Ac*E55*b1*c1/Ac1)/Ac1
    k0[i3*dof+4, i1*dof+4] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(0.0833333333333333*Ac*E45*b1*d1/Ac1 - 0.0833333333333333*Ac*E55*b1*c1/Ac1) + 0.0833333333333333*b1*d1*(0.0833333333333333*Ac*E44*b1*d1/Ac1 - 0.0833333333333333*Ac*E45*b1*c1/Ac1)/Ac1
    k0[i3*dof+4, i2*dof+2] += (a1/(2*Ac1) - 0.166666666666667*c1/Ac1)*(0.0833333333333333*Ac*E45*b1*d1/Ac1 - 0.0833333333333333*Ac*E55*b1*c1/Ac1) + (-b1/(2*Ac1) + 0.166666666666667*d1/Ac1)*(0.0833333333333333*Ac*E44*b1*d1/Ac1 - 0.0833333333333333*Ac*E45*b1*c1/Ac1)
    k0[i3*dof+4, i2*dof+3] += (0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1))*(0.0833333333333333*Ac*E44*b1*d1/Ac1 - 0.0833333333333333*Ac*E45*b1*c1/Ac1) + 0.166666666666667*a1*c1*(0.0833333333333333*Ac*E45*b1*d1/Ac1 - 0.0833333333333333*Ac*E55*b1*c1/Ac1)/Ac1
    k0[i3*dof+4, i2*dof+4] += (a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1)*(0.0833333333333333*Ac*E45*b1*d1/Ac1 - 0.0833333333333333*Ac*E55*b1*c1/Ac1) - 0.166666666666667*b1*d1*(0.0833333333333333*Ac*E44*b1*d1/Ac1 - 0.0833333333333333*Ac*E45*b1*c1/Ac1)/Ac1
    k0[i3*dof+4, i3*dof+2] += -0.166666666666667*c1*(0.0833333333333333*Ac*E45*b1*d1/Ac1 - 0.0833333333333333*Ac*E55*b1*c1/Ac1)/Ac1 + 0.166666666666667*d1*(0.0833333333333333*Ac*E44*b1*d1/Ac1 - 0.0833333333333333*Ac*E45*b1*c1/Ac1)/Ac1
    k0[i3*dof+4, i3*dof+3] += -0.0833333333333333*a1*c1*(0.0833333333333333*Ac*E45*b1*d1/Ac1 - 0.0833333333333333*Ac*E55*b1*c1/Ac1)/Ac1 + 0.0833333333333333*a1*d1*(0.0833333333333333*Ac*E44*b1*d1/Ac1 - 0.0833333333333333*Ac*E45*b1*c1/Ac1)/Ac1
    k0[i3*dof+4, i3*dof+4] += -0.0833333333333333*b1*c1*(0.0833333333333333*Ac*E45*b1*d1/Ac1 - 0.0833333333333333*Ac*E55*b1*c1/Ac1)/Ac1 + 0.0833333333333333*b1*d1*(0.0833333333333333*Ac*E44*b1*d1/Ac1 - 0.0833333333333333*Ac*E45*b1*c1/Ac1)/Ac1


def boundary_edge_tria1_n1n2mid1(k0, edge, prop_from_node):
    # tria1: n1 -> mid1 -> n2
    tria1 = edge.trias[0]
    mid1 = getMid(tria1)
    n1 = edge.n1
    n2 = edge.n2

    Ac = edge.Ac
    i1 = n1.index
    i2 = n2.index
    i3 = edge.othernode1.index

    tmp = np.array([n1.xyz, mid1, n2.xyz])
    Ac1 = area_of_polygon(tmp[:, 0], tmp[:, 1])
    x1, y1, z1 = n1.xyz
    x2, y2, z2 = n2.xyz
    x3, y3, z3 = mid1
    a1 = x2 - x1
    b1 = y2 - y1
    c1 = x3 - x1
    d1 = y3 - y1

    k = 5/6
    if prop_from_node:
        pn1 = n1.prop
        pn2 = n2.prop
        po1 = edge.othernode1.prop
        E = k*(4/9*pn1.E + 4/9*pn2.E + 1/9*po1.E)
    else:
        prop1 = tria1.prop
        E = k*prop1.E

    E44 = E[0, 0]
    E45 = E[0, 1]
    E55 = E[1, 1]

    k0[i1*dof+2, i1*dof+2] += (0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1))*(Ac*E45*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1))) + (-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1))*(Ac*E44*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)))
    k0[i1*dof+2, i1*dof+3] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(Ac*E44*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1))) + 0.0833333333333333*a1*c1*(Ac*E45*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1
    k0[i1*dof+2, i1*dof+4] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(Ac*E45*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1))) - 0.0833333333333333*b1*d1*(Ac*E44*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1
    k0[i1*dof+2, i2*dof+2] += (0.166666666666667*a1/Ac1 - c1/(2*Ac1))*(Ac*E45*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1))) + (-0.166666666666667*b1/Ac1 + d1/(2*Ac1))*(Ac*E44*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)))
    k0[i1*dof+2, i2*dof+3] += (Ac*E44*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)))*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*a1*c1*(Ac*E45*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1
    k0[i1*dof+2, i2*dof+4] += (Ac*E45*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)))*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*b1*d1*(Ac*E44*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1
    k0[i1*dof+2, i3*dof+2] += 0.166666666666667*a1*(Ac*E45*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1 - 0.166666666666667*b1*(Ac*E44*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1
    k0[i1*dof+2, i3*dof+3] += 0.0833333333333333*a1*c1*(Ac*E45*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1 - 0.0833333333333333*b1*c1*(Ac*E44*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1
    k0[i1*dof+2, i3*dof+4] += 0.0833333333333333*a1*d1*(Ac*E45*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1 - 0.0833333333333333*b1*d1*(Ac*E44*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)))/Ac1
    k0[i1*dof+3, i1*dof+2] += (0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1))*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E55*a1*c1/Ac1) + (-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1))*(Ac*E44*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*a1*c1/Ac1)
    k0[i1*dof+3, i1*dof+3] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(Ac*E44*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*a1*c1/Ac1) + 0.0833333333333333*a1*c1*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1
    k0[i1*dof+3, i1*dof+4] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E55*a1*c1/Ac1) - 0.0833333333333333*b1*d1*(Ac*E44*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i1*dof+3, i2*dof+2] += (0.166666666666667*a1/Ac1 - c1/(2*Ac1))*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E55*a1*c1/Ac1) + (-0.166666666666667*b1/Ac1 + d1/(2*Ac1))*(Ac*E44*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*a1*c1/Ac1)
    k0[i1*dof+3, i2*dof+3] += (Ac*E44*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*a1*c1/Ac1)*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*a1*c1*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1
    k0[i1*dof+3, i2*dof+4] += (Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E55*a1*c1/Ac1)*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*b1*d1*(Ac*E44*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i1*dof+3, i3*dof+2] += 0.166666666666667*a1*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1 - 0.166666666666667*b1*(Ac*E44*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i1*dof+3, i3*dof+3] += 0.0833333333333333*a1*c1*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1 - 0.0833333333333333*b1*c1*(Ac*E44*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i1*dof+3, i3*dof+4] += 0.0833333333333333*a1*d1*(Ac*E45*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1 - 0.0833333333333333*b1*d1*(Ac*E44*(1/2 - 0.0833333333333333*b1*c1/Ac1) + 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i1*dof+4, i1*dof+2] += (0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1))*(Ac*E55*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*b1*d1/Ac1) + (-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1))*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E44*b1*d1/Ac1)
    k0[i1*dof+4, i1*dof+3] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E44*b1*d1/Ac1) + 0.0833333333333333*a1*c1*(Ac*E55*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*b1*d1/Ac1)/Ac1
    k0[i1*dof+4, i1*dof+4] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(Ac*E55*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*b1*d1/Ac1) - 0.0833333333333333*b1*d1*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i1*dof+4, i2*dof+2] += (0.166666666666667*a1/Ac1 - c1/(2*Ac1))*(Ac*E55*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*b1*d1/Ac1) + (-0.166666666666667*b1/Ac1 + d1/(2*Ac1))*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E44*b1*d1/Ac1)
    k0[i1*dof+4, i2*dof+3] += (Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E44*b1*d1/Ac1)*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*a1*c1*(Ac*E55*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*b1*d1/Ac1)/Ac1
    k0[i1*dof+4, i2*dof+4] += (Ac*E55*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*b1*d1/Ac1)*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*b1*d1*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i1*dof+4, i3*dof+2] += 0.166666666666667*a1*(Ac*E55*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*b1*d1/Ac1)/Ac1 - 0.166666666666667*b1*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i1*dof+4, i3*dof+3] += 0.0833333333333333*a1*c1*(Ac*E55*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*b1*d1/Ac1)/Ac1 - 0.0833333333333333*b1*c1*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i1*dof+4, i3*dof+4] += 0.0833333333333333*a1*d1*(Ac*E55*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E45*b1*d1/Ac1)/Ac1 - 0.0833333333333333*b1*d1*(Ac*E45*(1/2 + 0.0833333333333333*a1*d1/Ac1) - 0.0833333333333333*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i2*dof+2, i1*dof+2] += (0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1))*(Ac*E45*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 - c1/(2*Ac1))) + (-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1))*(Ac*E44*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)))
    k0[i2*dof+2, i1*dof+3] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(Ac*E44*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 - c1/(2*Ac1))) + 0.0833333333333333*a1*c1*(Ac*E45*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)))/Ac1
    k0[i2*dof+2, i1*dof+4] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(Ac*E45*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 - c1/(2*Ac1))) - 0.0833333333333333*b1*d1*(Ac*E44*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)))/Ac1
    k0[i2*dof+2, i2*dof+2] += (0.166666666666667*a1/Ac1 - c1/(2*Ac1))*(Ac*E45*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 - c1/(2*Ac1))) + (-0.166666666666667*b1/Ac1 + d1/(2*Ac1))*(Ac*E44*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)))
    k0[i2*dof+2, i2*dof+3] += (Ac*E44*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)))*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*a1*c1*(Ac*E45*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)))/Ac1
    k0[i2*dof+2, i2*dof+4] += (Ac*E45*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)))*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*b1*d1*(Ac*E44*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)))/Ac1
    k0[i2*dof+2, i3*dof+2] += 0.166666666666667*a1*(Ac*E45*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)))/Ac1 - 0.166666666666667*b1*(Ac*E44*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)))/Ac1
    k0[i2*dof+2, i3*dof+3] += 0.0833333333333333*a1*c1*(Ac*E45*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)))/Ac1 - 0.0833333333333333*b1*c1*(Ac*E44*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)))/Ac1
    k0[i2*dof+2, i3*dof+4] += 0.0833333333333333*a1*d1*(Ac*E45*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E55*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)))/Ac1 - 0.0833333333333333*b1*d1*(Ac*E44*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac*E45*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)))/Ac1
    k0[i2*dof+3, i1*dof+2] += (0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1))*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E55*a1*c1/Ac1) + (-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1))*(Ac*E44*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*a1*c1/Ac1)
    k0[i2*dof+3, i1*dof+3] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(Ac*E44*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*a1*c1/Ac1) + 0.0833333333333333*a1*c1*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E55*a1*c1/Ac1)/Ac1
    k0[i2*dof+3, i1*dof+4] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E55*a1*c1/Ac1) - 0.0833333333333333*b1*d1*(Ac*E44*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i2*dof+3, i2*dof+2] += (0.166666666666667*a1/Ac1 - c1/(2*Ac1))*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E55*a1*c1/Ac1) + (-0.166666666666667*b1/Ac1 + d1/(2*Ac1))*(Ac*E44*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*a1*c1/Ac1)
    k0[i2*dof+3, i2*dof+3] += (Ac*E44*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*a1*c1/Ac1)*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*a1*c1*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E55*a1*c1/Ac1)/Ac1
    k0[i2*dof+3, i2*dof+4] += (Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E55*a1*c1/Ac1)*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*b1*d1*(Ac*E44*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i2*dof+3, i3*dof+2] += 0.166666666666667*a1*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E55*a1*c1/Ac1)/Ac1 - 0.166666666666667*b1*(Ac*E44*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i2*dof+3, i3*dof+3] += 0.0833333333333333*a1*c1*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E55*a1*c1/Ac1)/Ac1 - 0.0833333333333333*b1*c1*(Ac*E44*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i2*dof+3, i3*dof+4] += 0.0833333333333333*a1*d1*(Ac*E45*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E55*a1*c1/Ac1)/Ac1 - 0.0833333333333333*b1*d1*(Ac*E44*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i2*dof+4, i1*dof+2] += (0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1))*(Ac*E55*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*b1*d1/Ac1) + (-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1))*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E44*b1*d1/Ac1)
    k0[i2*dof+4, i1*dof+3] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E44*b1*d1/Ac1) + 0.0833333333333333*a1*c1*(Ac*E55*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*b1*d1/Ac1)/Ac1
    k0[i2*dof+4, i1*dof+4] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(Ac*E55*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*b1*d1/Ac1) - 0.0833333333333333*b1*d1*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i2*dof+4, i2*dof+2] += (0.166666666666667*a1/Ac1 - c1/(2*Ac1))*(Ac*E55*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*b1*d1/Ac1) + (-0.166666666666667*b1/Ac1 + d1/(2*Ac1))*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E44*b1*d1/Ac1)
    k0[i2*dof+4, i2*dof+3] += (Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E44*b1*d1/Ac1)*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) - 0.166666666666667*a1*c1*(Ac*E55*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*b1*d1/Ac1)/Ac1
    k0[i2*dof+4, i2*dof+4] += (Ac*E55*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*b1*d1/Ac1)*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*b1*d1*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i2*dof+4, i3*dof+2] += 0.166666666666667*a1*(Ac*E55*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*b1*d1/Ac1)/Ac1 - 0.166666666666667*b1*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i2*dof+4, i3*dof+3] += 0.0833333333333333*a1*c1*(Ac*E55*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*b1*d1/Ac1)/Ac1 - 0.0833333333333333*b1*c1*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i2*dof+4, i3*dof+4] += 0.0833333333333333*a1*d1*(Ac*E55*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E45*b1*d1/Ac1)/Ac1 - 0.0833333333333333*b1*d1*(Ac*E45*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + 0.166666666666667*Ac*E44*b1*d1/Ac1)/Ac1
    k0[i3*dof+2, i1*dof+2] += (0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1))*(-0.166666666666667*Ac*E45*b1/Ac1 + 0.166666666666667*Ac*E55*a1/Ac1) + (-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1))*(-0.166666666666667*Ac*E44*b1/Ac1 + 0.166666666666667*Ac*E45*a1/Ac1)
    k0[i3*dof+2, i1*dof+3] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(-0.166666666666667*Ac*E44*b1/Ac1 + 0.166666666666667*Ac*E45*a1/Ac1) + 0.0833333333333333*a1*c1*(-0.166666666666667*Ac*E45*b1/Ac1 + 0.166666666666667*Ac*E55*a1/Ac1)/Ac1
    k0[i3*dof+2, i1*dof+4] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(-0.166666666666667*Ac*E45*b1/Ac1 + 0.166666666666667*Ac*E55*a1/Ac1) - 0.0833333333333333*b1*d1*(-0.166666666666667*Ac*E44*b1/Ac1 + 0.166666666666667*Ac*E45*a1/Ac1)/Ac1
    k0[i3*dof+2, i2*dof+2] += (0.166666666666667*a1/Ac1 - c1/(2*Ac1))*(-0.166666666666667*Ac*E45*b1/Ac1 + 0.166666666666667*Ac*E55*a1/Ac1) + (-0.166666666666667*b1/Ac1 + d1/(2*Ac1))*(-0.166666666666667*Ac*E44*b1/Ac1 + 0.166666666666667*Ac*E45*a1/Ac1)
    k0[i3*dof+2, i2*dof+3] += (a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1)*(-0.166666666666667*Ac*E44*b1/Ac1 + 0.166666666666667*Ac*E45*a1/Ac1) - 0.166666666666667*a1*c1*(-0.166666666666667*Ac*E45*b1/Ac1 + 0.166666666666667*Ac*E55*a1/Ac1)/Ac1
    k0[i3*dof+2, i2*dof+4] += (0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1))*(-0.166666666666667*Ac*E45*b1/Ac1 + 0.166666666666667*Ac*E55*a1/Ac1) + 0.166666666666667*b1*d1*(-0.166666666666667*Ac*E44*b1/Ac1 + 0.166666666666667*Ac*E45*a1/Ac1)/Ac1
    k0[i3*dof+2, i3*dof+2] += 0.166666666666667*a1*(-0.166666666666667*Ac*E45*b1/Ac1 + 0.166666666666667*Ac*E55*a1/Ac1)/Ac1 - 0.166666666666667*b1*(-0.166666666666667*Ac*E44*b1/Ac1 + 0.166666666666667*Ac*E45*a1/Ac1)/Ac1
    k0[i3*dof+2, i3*dof+3] += 0.0833333333333333*a1*c1*(-0.166666666666667*Ac*E45*b1/Ac1 + 0.166666666666667*Ac*E55*a1/Ac1)/Ac1 - 0.0833333333333333*b1*c1*(-0.166666666666667*Ac*E44*b1/Ac1 + 0.166666666666667*Ac*E45*a1/Ac1)/Ac1
    k0[i3*dof+2, i3*dof+4] += 0.0833333333333333*a1*d1*(-0.166666666666667*Ac*E45*b1/Ac1 + 0.166666666666667*Ac*E55*a1/Ac1)/Ac1 - 0.0833333333333333*b1*d1*(-0.166666666666667*Ac*E44*b1/Ac1 + 0.166666666666667*Ac*E45*a1/Ac1)/Ac1
    k0[i3*dof+3, i1*dof+2] += (0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1))*(-0.0833333333333333*Ac*E45*b1*c1/Ac1 + 0.0833333333333333*Ac*E55*a1*c1/Ac1) + (-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1))*(-0.0833333333333333*Ac*E44*b1*c1/Ac1 + 0.0833333333333333*Ac*E45*a1*c1/Ac1)
    k0[i3*dof+3, i1*dof+3] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(-0.0833333333333333*Ac*E44*b1*c1/Ac1 + 0.0833333333333333*Ac*E45*a1*c1/Ac1) + 0.0833333333333333*a1*c1*(-0.0833333333333333*Ac*E45*b1*c1/Ac1 + 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1
    k0[i3*dof+3, i1*dof+4] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(-0.0833333333333333*Ac*E45*b1*c1/Ac1 + 0.0833333333333333*Ac*E55*a1*c1/Ac1) - 0.0833333333333333*b1*d1*(-0.0833333333333333*Ac*E44*b1*c1/Ac1 + 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i3*dof+3, i2*dof+2] += (0.166666666666667*a1/Ac1 - c1/(2*Ac1))*(-0.0833333333333333*Ac*E45*b1*c1/Ac1 + 0.0833333333333333*Ac*E55*a1*c1/Ac1) + (-0.166666666666667*b1/Ac1 + d1/(2*Ac1))*(-0.0833333333333333*Ac*E44*b1*c1/Ac1 + 0.0833333333333333*Ac*E45*a1*c1/Ac1)
    k0[i3*dof+3, i2*dof+3] += (a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1)*(-0.0833333333333333*Ac*E44*b1*c1/Ac1 + 0.0833333333333333*Ac*E45*a1*c1/Ac1) - 0.166666666666667*a1*c1*(-0.0833333333333333*Ac*E45*b1*c1/Ac1 + 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1
    k0[i3*dof+3, i2*dof+4] += (0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1))*(-0.0833333333333333*Ac*E45*b1*c1/Ac1 + 0.0833333333333333*Ac*E55*a1*c1/Ac1) + 0.166666666666667*b1*d1*(-0.0833333333333333*Ac*E44*b1*c1/Ac1 + 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i3*dof+3, i3*dof+2] += 0.166666666666667*a1*(-0.0833333333333333*Ac*E45*b1*c1/Ac1 + 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1 - 0.166666666666667*b1*(-0.0833333333333333*Ac*E44*b1*c1/Ac1 + 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i3*dof+3, i3*dof+3] += 0.0833333333333333*a1*c1*(-0.0833333333333333*Ac*E45*b1*c1/Ac1 + 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1 - 0.0833333333333333*b1*c1*(-0.0833333333333333*Ac*E44*b1*c1/Ac1 + 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i3*dof+3, i3*dof+4] += 0.0833333333333333*a1*d1*(-0.0833333333333333*Ac*E45*b1*c1/Ac1 + 0.0833333333333333*Ac*E55*a1*c1/Ac1)/Ac1 - 0.0833333333333333*b1*d1*(-0.0833333333333333*Ac*E44*b1*c1/Ac1 + 0.0833333333333333*Ac*E45*a1*c1/Ac1)/Ac1
    k0[i3*dof+4, i1*dof+2] += (0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1))*(-0.0833333333333333*Ac*E45*b1*d1/Ac1 + 0.0833333333333333*Ac*E55*a1*d1/Ac1) + (-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1))*(-0.0833333333333333*Ac*E44*b1*d1/Ac1 + 0.0833333333333333*Ac*E45*a1*d1/Ac1)
    k0[i3*dof+4, i1*dof+3] += (1/2 - 0.0833333333333333*b1*c1/Ac1)*(-0.0833333333333333*Ac*E44*b1*d1/Ac1 + 0.0833333333333333*Ac*E45*a1*d1/Ac1) + 0.0833333333333333*a1*c1*(-0.0833333333333333*Ac*E45*b1*d1/Ac1 + 0.0833333333333333*Ac*E55*a1*d1/Ac1)/Ac1
    k0[i3*dof+4, i1*dof+4] += (1/2 + 0.0833333333333333*a1*d1/Ac1)*(-0.0833333333333333*Ac*E45*b1*d1/Ac1 + 0.0833333333333333*Ac*E55*a1*d1/Ac1) - 0.0833333333333333*b1*d1*(-0.0833333333333333*Ac*E44*b1*d1/Ac1 + 0.0833333333333333*Ac*E45*a1*d1/Ac1)/Ac1
    k0[i3*dof+4, i2*dof+2] += (0.166666666666667*a1/Ac1 - c1/(2*Ac1))*(-0.0833333333333333*Ac*E45*b1*d1/Ac1 + 0.0833333333333333*Ac*E55*a1*d1/Ac1) + (-0.166666666666667*b1/Ac1 + d1/(2*Ac1))*(-0.0833333333333333*Ac*E44*b1*d1/Ac1 + 0.0833333333333333*Ac*E45*a1*d1/Ac1)
    k0[i3*dof+4, i2*dof+3] += (a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1)*(-0.0833333333333333*Ac*E44*b1*d1/Ac1 + 0.0833333333333333*Ac*E45*a1*d1/Ac1) - 0.166666666666667*a1*c1*(-0.0833333333333333*Ac*E45*b1*d1/Ac1 + 0.0833333333333333*Ac*E55*a1*d1/Ac1)/Ac1
    k0[i3*dof+4, i2*dof+4] += (0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1))*(-0.0833333333333333*Ac*E45*b1*d1/Ac1 + 0.0833333333333333*Ac*E55*a1*d1/Ac1) + 0.166666666666667*b1*d1*(-0.0833333333333333*Ac*E44*b1*d1/Ac1 + 0.0833333333333333*Ac*E45*a1*d1/Ac1)/Ac1
    k0[i3*dof+4, i3*dof+2] += 0.166666666666667*a1*(-0.0833333333333333*Ac*E45*b1*d1/Ac1 + 0.0833333333333333*Ac*E55*a1*d1/Ac1)/Ac1 - 0.166666666666667*b1*(-0.0833333333333333*Ac*E44*b1*d1/Ac1 + 0.0833333333333333*Ac*E45*a1*d1/Ac1)/Ac1
    k0[i3*dof+4, i3*dof+3] += 0.0833333333333333*a1*c1*(-0.0833333333333333*Ac*E45*b1*d1/Ac1 + 0.0833333333333333*Ac*E55*a1*d1/Ac1)/Ac1 - 0.0833333333333333*b1*c1*(-0.0833333333333333*Ac*E44*b1*d1/Ac1 + 0.0833333333333333*Ac*E45*a1*d1/Ac1)/Ac1
    k0[i3*dof+4, i3*dof+4] += 0.0833333333333333*a1*d1*(-0.0833333333333333*Ac*E45*b1*d1/Ac1 + 0.0833333333333333*Ac*E55*a1*d1/Ac1)/Ac1 - 0.0833333333333333*b1*d1*(-0.0833333333333333*Ac*E44*b1*d1/Ac1 + 0.0833333333333333*Ac*E45*a1*d1/Ac1)/Ac1


def interior_edge_tria1_n1mid1n2(k0, edge, prop_from_node):
    # sub-tria1: n1 -> mid1 -> n2
    # sub-tria2: n1 -> n2 -> mid2
    tria1 = edge.trias[0]
    tria2 = edge.trias[1]
    mid1 = getMid(tria1)
    mid2 = getMid(tria2)

    n1 = edge.n1
    n2 = edge.n2

    Ac = edge.Ac
    i1 = n1.index
    i2 = n2.index
    i3 = edge.othernode1.index
    i4 = edge.othernode2.index

    # sub-tria 1
    tmp = np.array([n1.xyz, mid1, n2.xyz])
    Ac1 = area_of_polygon(tmp[:, 0], tmp[:, 1])
    x1, y1, z1 = n1.xyz
    x2, y2, z2 = mid1
    x3, y3, z3 = n2.xyz
    a1 = x2 - x1
    b1 = y2 - y1
    c1 = x3 - x1
    d1 = y3 - y1

    tmp = np.array([n1.xyz, n2.xyz, mid2])
    Ac2 = area_of_polygon(tmp[:, 0], tmp[:, 1])
    x1, y1, z1 = n1.xyz
    x2, y2, z2 = n2.xyz
    x3, y3, z3 = mid2
    a2 = x2 - x1
    b2 = y2 - y1
    c2 = x3 - x1
    d2 = y3 - y1

    k = 5/6
    if prop_from_node:
        pn1 = n1.prop
        pn2 = n2.prop
        po1 = edge.othernode1.prop
        po2 = edge.othernode2.prop
        E = k*(5/12*pn1.E + 5/12*pn2.E + 1/12*po1.E + 1/12*po2.E)
    else:
        prop1 = tria1.prop
        prop2 = tria2.prop
        E = k*(Ac1*prop1.E + Ac2*prop2.E)/Ac

    E44 = E[0, 0]
    E45 = E[0, 1]
    E55 = E[1, 1]

    k0[i1*dof+2, i1*dof+2] += (Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2)))*(E45*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + (Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2)))*(E44*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+2, i1*dof+3] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(E44*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + (E45*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2)/Ac
    k0[i1*dof+2, i1*dof+4] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(E45*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + (E44*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2)/Ac
    k0[i1*dof+2, i2*dof+2] += (Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2)))*(E45*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2)))*(E44*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+2, i2*dof+3] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(E44*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + (E45*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2)/Ac
    k0[i1*dof+2, i2*dof+4] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(E45*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + (E44*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2)/Ac
    k0[i1*dof+2, i3*dof+2] += -0.166666666666667*c1*(E45*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + 0.166666666666667*d1*(E44*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+2, i3*dof+3] += -0.0833333333333333*a1*c1*(E45*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + 0.0833333333333333*a1*d1*(E44*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+2, i3*dof+4] += -0.0833333333333333*b1*c1*(E45*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + 0.0833333333333333*b1*d1*(E44*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+2, i4*dof+2] += 0.166666666666667*a2*(E45*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac - 0.166666666666667*b2*(E44*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+2, i4*dof+3] += 0.0833333333333333*a2*c2*(E45*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac - 0.0833333333333333*b2*c2*(E44*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+2, i4*dof+4] += 0.0833333333333333*a2*d2*(E45*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac - 0.0833333333333333*b2*d2*(E44*(Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+3, i1*dof+2] += (Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2)))*(E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E55*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac + (Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2)))*(E44*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E45*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+3, i1*dof+3] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(E44*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E45*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac + (E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E55*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2)/Ac
    k0[i1*dof+3, i1*dof+4] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E55*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac + (E44*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E45*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2)/Ac
    k0[i1*dof+3, i2*dof+2] += (Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2)))*(E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E55*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2)))*(E44*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E45*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+3, i2*dof+3] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(E44*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E45*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac + (E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E55*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2)/Ac
    k0[i1*dof+3, i2*dof+4] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E55*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac + (E44*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E45*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2)/Ac
    k0[i1*dof+3, i3*dof+2] += -0.166666666666667*c1*(E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E55*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac + 0.166666666666667*d1*(E44*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E45*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+3, i3*dof+3] += -0.0833333333333333*a1*c1*(E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E55*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac + 0.0833333333333333*a1*d1*(E44*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E45*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+3, i3*dof+4] += -0.0833333333333333*b1*c1*(E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E55*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac + 0.0833333333333333*b1*d1*(E44*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E45*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+3, i4*dof+2] += 0.166666666666667*a2*(E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E55*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac - 0.166666666666667*b2*(E44*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E45*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+3, i4*dof+3] += 0.0833333333333333*a2*c2*(E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E55*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac - 0.0833333333333333*b2*c2*(E44*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E45*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+3, i4*dof+4] += 0.0833333333333333*a2*d2*(E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E55*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac - 0.0833333333333333*b2*d2*(E44*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)) + E45*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+4, i1*dof+2] += (Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2)))*(E45*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac + (Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2)))*(E44*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac
    k0[i1*dof+4, i1*dof+3] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(E44*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac + (E45*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2)/Ac
    k0[i1*dof+4, i1*dof+4] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(E45*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac + (E44*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2)/Ac
    k0[i1*dof+4, i2*dof+2] += (Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2)))*(E45*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2)))*(E44*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac
    k0[i1*dof+4, i2*dof+3] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(E44*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac + (E45*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2)/Ac
    k0[i1*dof+4, i2*dof+4] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(E45*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac + (E44*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2)/Ac
    k0[i1*dof+4, i3*dof+2] += -0.166666666666667*c1*(E45*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac + 0.166666666666667*d1*(E44*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac
    k0[i1*dof+4, i3*dof+3] += -0.0833333333333333*a1*c1*(E45*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac + 0.0833333333333333*a1*d1*(E44*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac
    k0[i1*dof+4, i3*dof+4] += -0.0833333333333333*b1*c1*(E45*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac + 0.0833333333333333*b1*d1*(E44*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac
    k0[i1*dof+4, i4*dof+2] += 0.166666666666667*a2*(E45*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac - 0.166666666666667*b2*(E44*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac
    k0[i1*dof+4, i4*dof+3] += 0.0833333333333333*a2*c2*(E45*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac - 0.0833333333333333*b2*c2*(E44*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac
    k0[i1*dof+4, i4*dof+4] += 0.0833333333333333*a2*d2*(E45*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac - 0.0833333333333333*b2*d2*(E44*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)))/Ac
    k0[i2*dof+2, i1*dof+2] += (Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2)))*(E45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E55*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac + (Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2)))*(E44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E45*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac
    k0[i2*dof+2, i1*dof+3] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(E44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E45*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac + (E45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E55*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2)/Ac
    k0[i2*dof+2, i1*dof+4] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(E45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E55*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac + (E44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E45*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2)/Ac
    k0[i2*dof+2, i2*dof+2] += (Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2)))*(E45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E55*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2)))*(E44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E45*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac
    k0[i2*dof+2, i2*dof+3] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(E44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E45*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac + (E45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E55*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2)/Ac
    k0[i2*dof+2, i2*dof+4] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(E45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E55*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac + (E44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E45*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2)/Ac
    k0[i2*dof+2, i3*dof+2] += -0.166666666666667*c1*(E45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E55*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac + 0.166666666666667*d1*(E44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E45*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac
    k0[i2*dof+2, i3*dof+3] += -0.0833333333333333*a1*c1*(E45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E55*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac + 0.0833333333333333*a1*d1*(E44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E45*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac
    k0[i2*dof+2, i3*dof+4] += -0.0833333333333333*b1*c1*(E45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E55*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac + 0.0833333333333333*b1*d1*(E44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E45*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac
    k0[i2*dof+2, i4*dof+2] += 0.166666666666667*a2*(E45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E55*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac - 0.166666666666667*b2*(E44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E45*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac
    k0[i2*dof+2, i4*dof+3] += 0.0833333333333333*a2*c2*(E45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E55*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac - 0.0833333333333333*b2*c2*(E44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E45*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac
    k0[i2*dof+2, i4*dof+4] += 0.0833333333333333*a2*d2*(E45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E55*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac - 0.0833333333333333*b2*d2*(E44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2))) + E45*(Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2))))/Ac
    k0[i2*dof+3, i1*dof+2] += (Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2)))*(E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E55*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac + (Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2)))*(E44*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E45*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+3, i1*dof+3] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(E44*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E45*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac + (E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E55*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2)/Ac
    k0[i2*dof+3, i1*dof+4] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E55*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac + (E44*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E45*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2)/Ac
    k0[i2*dof+3, i2*dof+2] += (Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2)))*(E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E55*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2)))*(E44*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E45*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+3, i2*dof+3] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(E44*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E45*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac + (E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E55*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2)/Ac
    k0[i2*dof+3, i2*dof+4] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E55*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac + (E44*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E45*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2)/Ac
    k0[i2*dof+3, i3*dof+2] += -0.166666666666667*c1*(E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E55*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac + 0.166666666666667*d1*(E44*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E45*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+3, i3*dof+3] += -0.0833333333333333*a1*c1*(E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E55*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac + 0.0833333333333333*a1*d1*(E44*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E45*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+3, i3*dof+4] += -0.0833333333333333*b1*c1*(E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E55*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac + 0.0833333333333333*b1*d1*(E44*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E45*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+3, i4*dof+2] += 0.166666666666667*a2*(E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E55*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac - 0.166666666666667*b2*(E44*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E45*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+3, i4*dof+3] += 0.0833333333333333*a2*c2*(E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E55*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac - 0.0833333333333333*b2*c2*(E44*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E45*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+3, i4*dof+4] += 0.0833333333333333*a2*d2*(E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E55*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac - 0.0833333333333333*b2*d2*(E44*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)) + E45*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+4, i1*dof+2] += (Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2)))*(E45*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E55*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac + (Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2)))*(E44*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac
    k0[i2*dof+4, i1*dof+3] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(E44*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac + (E45*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E55*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2)/Ac
    k0[i2*dof+4, i1*dof+4] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(E45*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E55*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac + (E44*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2)/Ac
    k0[i2*dof+4, i2*dof+2] += (Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2)))*(E45*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E55*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2)))*(E44*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac
    k0[i2*dof+4, i2*dof+3] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(E44*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac + (E45*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E55*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2)/Ac
    k0[i2*dof+4, i2*dof+4] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(E45*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E55*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac + (E44*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2)/Ac
    k0[i2*dof+4, i3*dof+2] += -0.166666666666667*c1*(E45*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E55*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac + 0.166666666666667*d1*(E44*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac
    k0[i2*dof+4, i3*dof+3] += -0.0833333333333333*a1*c1*(E45*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E55*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac + 0.0833333333333333*a1*d1*(E44*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac
    k0[i2*dof+4, i3*dof+4] += -0.0833333333333333*b1*c1*(E45*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E55*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac + 0.0833333333333333*b1*d1*(E44*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac
    k0[i2*dof+4, i4*dof+2] += 0.166666666666667*a2*(E45*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E55*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac - 0.166666666666667*b2*(E44*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac
    k0[i2*dof+4, i4*dof+3] += 0.0833333333333333*a2*c2*(E45*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E55*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac - 0.0833333333333333*b2*c2*(E44*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac
    k0[i2*dof+4, i4*dof+4] += 0.0833333333333333*a2*d2*(E45*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E55*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac - 0.0833333333333333*b2*d2*(E44*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2) + E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))))/Ac
    k0[i3*dof+2, i1*dof+2] += (Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2)))*(0.166666666666667*E45*d1 - 0.166666666666667*E55*c1)/Ac + (Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2)))*(0.166666666666667*E44*d1 - 0.166666666666667*E45*c1)/Ac
    k0[i3*dof+2, i1*dof+3] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(0.166666666666667*E44*d1 - 0.166666666666667*E45*c1)/Ac + (0.166666666666667*E45*d1 - 0.166666666666667*E55*c1)*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2)/Ac
    k0[i3*dof+2, i1*dof+4] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(0.166666666666667*E45*d1 - 0.166666666666667*E55*c1)/Ac + (0.166666666666667*E44*d1 - 0.166666666666667*E45*c1)*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2)/Ac
    k0[i3*dof+2, i2*dof+2] += (Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2)))*(0.166666666666667*E45*d1 - 0.166666666666667*E55*c1)/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2)))*(0.166666666666667*E44*d1 - 0.166666666666667*E45*c1)/Ac
    k0[i3*dof+2, i2*dof+3] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(0.166666666666667*E44*d1 - 0.166666666666667*E45*c1)/Ac + (0.166666666666667*E45*d1 - 0.166666666666667*E55*c1)*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2)/Ac
    k0[i3*dof+2, i2*dof+4] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(0.166666666666667*E45*d1 - 0.166666666666667*E55*c1)/Ac + (0.166666666666667*E44*d1 - 0.166666666666667*E45*c1)*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2)/Ac
    k0[i3*dof+2, i3*dof+2] += -0.166666666666667*c1*(0.166666666666667*E45*d1 - 0.166666666666667*E55*c1)/Ac + 0.166666666666667*d1*(0.166666666666667*E44*d1 - 0.166666666666667*E45*c1)/Ac
    k0[i3*dof+2, i3*dof+3] += -0.0833333333333333*a1*c1*(0.166666666666667*E45*d1 - 0.166666666666667*E55*c1)/Ac + 0.0833333333333333*a1*d1*(0.166666666666667*E44*d1 - 0.166666666666667*E45*c1)/Ac
    k0[i3*dof+2, i3*dof+4] += -0.0833333333333333*b1*c1*(0.166666666666667*E45*d1 - 0.166666666666667*E55*c1)/Ac + 0.0833333333333333*b1*d1*(0.166666666666667*E44*d1 - 0.166666666666667*E45*c1)/Ac
    k0[i3*dof+2, i4*dof+2] += 0.166666666666667*a2*(0.166666666666667*E45*d1 - 0.166666666666667*E55*c1)/Ac - 0.166666666666667*b2*(0.166666666666667*E44*d1 - 0.166666666666667*E45*c1)/Ac
    k0[i3*dof+2, i4*dof+3] += 0.0833333333333333*a2*c2*(0.166666666666667*E45*d1 - 0.166666666666667*E55*c1)/Ac - 0.0833333333333333*b2*c2*(0.166666666666667*E44*d1 - 0.166666666666667*E45*c1)/Ac
    k0[i3*dof+2, i4*dof+4] += 0.0833333333333333*a2*d2*(0.166666666666667*E45*d1 - 0.166666666666667*E55*c1)/Ac - 0.0833333333333333*b2*d2*(0.166666666666667*E44*d1 - 0.166666666666667*E45*c1)/Ac
    k0[i3*dof+3, i1*dof+2] += (Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2)))*(0.0833333333333333*E45*a1*d1 - 0.0833333333333333*E55*a1*c1)/Ac + (Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2)))*(0.0833333333333333*E44*a1*d1 - 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i1*dof+3] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(0.0833333333333333*E44*a1*d1 - 0.0833333333333333*E45*a1*c1)/Ac + (-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2)*(0.0833333333333333*E45*a1*d1 - 0.0833333333333333*E55*a1*c1)/Ac
    k0[i3*dof+3, i1*dof+4] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(0.0833333333333333*E45*a1*d1 - 0.0833333333333333*E55*a1*c1)/Ac + (0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2)*(0.0833333333333333*E44*a1*d1 - 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i2*dof+2] += (Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2)))*(0.0833333333333333*E45*a1*d1 - 0.0833333333333333*E55*a1*c1)/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2)))*(0.0833333333333333*E44*a1*d1 - 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i2*dof+3] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(0.0833333333333333*E44*a1*d1 - 0.0833333333333333*E45*a1*c1)/Ac + (0.166666666666667*a1*c1 - 0.166666666666667*a2*c2)*(0.0833333333333333*E45*a1*d1 - 0.0833333333333333*E55*a1*c1)/Ac
    k0[i3*dof+3, i2*dof+4] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(0.0833333333333333*E45*a1*d1 - 0.0833333333333333*E55*a1*c1)/Ac + (-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2)*(0.0833333333333333*E44*a1*d1 - 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i3*dof+2] += -0.166666666666667*c1*(0.0833333333333333*E45*a1*d1 - 0.0833333333333333*E55*a1*c1)/Ac + 0.166666666666667*d1*(0.0833333333333333*E44*a1*d1 - 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i3*dof+3] += -0.0833333333333333*a1*c1*(0.0833333333333333*E45*a1*d1 - 0.0833333333333333*E55*a1*c1)/Ac + 0.0833333333333333*a1*d1*(0.0833333333333333*E44*a1*d1 - 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i3*dof+4] += -0.0833333333333333*b1*c1*(0.0833333333333333*E45*a1*d1 - 0.0833333333333333*E55*a1*c1)/Ac + 0.0833333333333333*b1*d1*(0.0833333333333333*E44*a1*d1 - 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i4*dof+2] += 0.166666666666667*a2*(0.0833333333333333*E45*a1*d1 - 0.0833333333333333*E55*a1*c1)/Ac - 0.166666666666667*b2*(0.0833333333333333*E44*a1*d1 - 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i4*dof+3] += 0.0833333333333333*a2*c2*(0.0833333333333333*E45*a1*d1 - 0.0833333333333333*E55*a1*c1)/Ac - 0.0833333333333333*b2*c2*(0.0833333333333333*E44*a1*d1 - 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i4*dof+4] += 0.0833333333333333*a2*d2*(0.0833333333333333*E45*a1*d1 - 0.0833333333333333*E55*a1*c1)/Ac - 0.0833333333333333*b2*d2*(0.0833333333333333*E44*a1*d1 - 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+4, i1*dof+2] += (Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2)))*(0.0833333333333333*E45*b1*d1 - 0.0833333333333333*E55*b1*c1)/Ac + (Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2)))*(0.0833333333333333*E44*b1*d1 - 0.0833333333333333*E45*b1*c1)/Ac
    k0[i3*dof+4, i1*dof+3] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(0.0833333333333333*E44*b1*d1 - 0.0833333333333333*E45*b1*c1)/Ac + (-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2)*(0.0833333333333333*E45*b1*d1 - 0.0833333333333333*E55*b1*c1)/Ac
    k0[i3*dof+4, i1*dof+4] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(0.0833333333333333*E45*b1*d1 - 0.0833333333333333*E55*b1*c1)/Ac + (0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2)*(0.0833333333333333*E44*b1*d1 - 0.0833333333333333*E45*b1*c1)/Ac
    k0[i3*dof+4, i2*dof+2] += (Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2)))*(0.0833333333333333*E45*b1*d1 - 0.0833333333333333*E55*b1*c1)/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2)))*(0.0833333333333333*E44*b1*d1 - 0.0833333333333333*E45*b1*c1)/Ac
    k0[i3*dof+4, i2*dof+3] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(0.0833333333333333*E44*b1*d1 - 0.0833333333333333*E45*b1*c1)/Ac + (0.166666666666667*a1*c1 - 0.166666666666667*a2*c2)*(0.0833333333333333*E45*b1*d1 - 0.0833333333333333*E55*b1*c1)/Ac
    k0[i3*dof+4, i2*dof+4] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(0.0833333333333333*E45*b1*d1 - 0.0833333333333333*E55*b1*c1)/Ac + (-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2)*(0.0833333333333333*E44*b1*d1 - 0.0833333333333333*E45*b1*c1)/Ac
    k0[i3*dof+4, i3*dof+2] += -0.166666666666667*c1*(0.0833333333333333*E45*b1*d1 - 0.0833333333333333*E55*b1*c1)/Ac + 0.166666666666667*d1*(0.0833333333333333*E44*b1*d1 - 0.0833333333333333*E45*b1*c1)/Ac
    k0[i3*dof+4, i3*dof+3] += -0.0833333333333333*a1*c1*(0.0833333333333333*E45*b1*d1 - 0.0833333333333333*E55*b1*c1)/Ac + 0.0833333333333333*a1*d1*(0.0833333333333333*E44*b1*d1 - 0.0833333333333333*E45*b1*c1)/Ac
    k0[i3*dof+4, i3*dof+4] += -0.0833333333333333*b1*c1*(0.0833333333333333*E45*b1*d1 - 0.0833333333333333*E55*b1*c1)/Ac + 0.0833333333333333*b1*d1*(0.0833333333333333*E44*b1*d1 - 0.0833333333333333*E45*b1*c1)/Ac
    k0[i3*dof+4, i4*dof+2] += 0.166666666666667*a2*(0.0833333333333333*E45*b1*d1 - 0.0833333333333333*E55*b1*c1)/Ac - 0.166666666666667*b2*(0.0833333333333333*E44*b1*d1 - 0.0833333333333333*E45*b1*c1)/Ac
    k0[i3*dof+4, i4*dof+3] += 0.0833333333333333*a2*c2*(0.0833333333333333*E45*b1*d1 - 0.0833333333333333*E55*b1*c1)/Ac - 0.0833333333333333*b2*c2*(0.0833333333333333*E44*b1*d1 - 0.0833333333333333*E45*b1*c1)/Ac
    k0[i3*dof+4, i4*dof+4] += 0.0833333333333333*a2*d2*(0.0833333333333333*E45*b1*d1 - 0.0833333333333333*E55*b1*c1)/Ac - 0.0833333333333333*b2*d2*(0.0833333333333333*E44*b1*d1 - 0.0833333333333333*E45*b1*c1)/Ac
    k0[i4*dof+2, i1*dof+2] += (Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2)))*(-0.166666666666667*E45*b2 + 0.166666666666667*E55*a2)/Ac + (Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2)))*(-0.166666666666667*E44*b2 + 0.166666666666667*E45*a2)/Ac
    k0[i4*dof+2, i1*dof+3] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(-0.166666666666667*E44*b2 + 0.166666666666667*E45*a2)/Ac + (-0.166666666666667*E45*b2 + 0.166666666666667*E55*a2)*(-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2)/Ac
    k0[i4*dof+2, i1*dof+4] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(-0.166666666666667*E45*b2 + 0.166666666666667*E55*a2)/Ac + (-0.166666666666667*E44*b2 + 0.166666666666667*E45*a2)*(0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2)/Ac
    k0[i4*dof+2, i2*dof+2] += (Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2)))*(-0.166666666666667*E45*b2 + 0.166666666666667*E55*a2)/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2)))*(-0.166666666666667*E44*b2 + 0.166666666666667*E45*a2)/Ac
    k0[i4*dof+2, i2*dof+3] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(-0.166666666666667*E44*b2 + 0.166666666666667*E45*a2)/Ac + (-0.166666666666667*E45*b2 + 0.166666666666667*E55*a2)*(0.166666666666667*a1*c1 - 0.166666666666667*a2*c2)/Ac
    k0[i4*dof+2, i2*dof+4] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(-0.166666666666667*E45*b2 + 0.166666666666667*E55*a2)/Ac + (-0.166666666666667*E44*b2 + 0.166666666666667*E45*a2)*(-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2)/Ac
    k0[i4*dof+2, i3*dof+2] += -0.166666666666667*c1*(-0.166666666666667*E45*b2 + 0.166666666666667*E55*a2)/Ac + 0.166666666666667*d1*(-0.166666666666667*E44*b2 + 0.166666666666667*E45*a2)/Ac
    k0[i4*dof+2, i3*dof+3] += -0.0833333333333333*a1*c1*(-0.166666666666667*E45*b2 + 0.166666666666667*E55*a2)/Ac + 0.0833333333333333*a1*d1*(-0.166666666666667*E44*b2 + 0.166666666666667*E45*a2)/Ac
    k0[i4*dof+2, i3*dof+4] += -0.0833333333333333*b1*c1*(-0.166666666666667*E45*b2 + 0.166666666666667*E55*a2)/Ac + 0.0833333333333333*b1*d1*(-0.166666666666667*E44*b2 + 0.166666666666667*E45*a2)/Ac
    k0[i4*dof+2, i4*dof+2] += 0.166666666666667*a2*(-0.166666666666667*E45*b2 + 0.166666666666667*E55*a2)/Ac - 0.166666666666667*b2*(-0.166666666666667*E44*b2 + 0.166666666666667*E45*a2)/Ac
    k0[i4*dof+2, i4*dof+3] += 0.0833333333333333*a2*c2*(-0.166666666666667*E45*b2 + 0.166666666666667*E55*a2)/Ac - 0.0833333333333333*b2*c2*(-0.166666666666667*E44*b2 + 0.166666666666667*E45*a2)/Ac
    k0[i4*dof+2, i4*dof+4] += 0.0833333333333333*a2*d2*(-0.166666666666667*E45*b2 + 0.166666666666667*E55*a2)/Ac - 0.0833333333333333*b2*d2*(-0.166666666666667*E44*b2 + 0.166666666666667*E45*a2)/Ac
    k0[i4*dof+3, i1*dof+2] += (Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2)))*(-0.0833333333333333*E45*b2*c2 + 0.0833333333333333*E55*a2*c2)/Ac + (Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2)))*(-0.0833333333333333*E44*b2*c2 + 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i1*dof+3] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(-0.0833333333333333*E44*b2*c2 + 0.0833333333333333*E45*a2*c2)/Ac + (-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2)*(-0.0833333333333333*E45*b2*c2 + 0.0833333333333333*E55*a2*c2)/Ac
    k0[i4*dof+3, i1*dof+4] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(-0.0833333333333333*E45*b2*c2 + 0.0833333333333333*E55*a2*c2)/Ac + (0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2)*(-0.0833333333333333*E44*b2*c2 + 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i2*dof+2] += (Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2)))*(-0.0833333333333333*E45*b2*c2 + 0.0833333333333333*E55*a2*c2)/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2)))*(-0.0833333333333333*E44*b2*c2 + 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i2*dof+3] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(-0.0833333333333333*E44*b2*c2 + 0.0833333333333333*E45*a2*c2)/Ac + (0.166666666666667*a1*c1 - 0.166666666666667*a2*c2)*(-0.0833333333333333*E45*b2*c2 + 0.0833333333333333*E55*a2*c2)/Ac
    k0[i4*dof+3, i2*dof+4] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(-0.0833333333333333*E45*b2*c2 + 0.0833333333333333*E55*a2*c2)/Ac + (-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2)*(-0.0833333333333333*E44*b2*c2 + 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i3*dof+2] += -0.166666666666667*c1*(-0.0833333333333333*E45*b2*c2 + 0.0833333333333333*E55*a2*c2)/Ac + 0.166666666666667*d1*(-0.0833333333333333*E44*b2*c2 + 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i3*dof+3] += -0.0833333333333333*a1*c1*(-0.0833333333333333*E45*b2*c2 + 0.0833333333333333*E55*a2*c2)/Ac + 0.0833333333333333*a1*d1*(-0.0833333333333333*E44*b2*c2 + 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i3*dof+4] += -0.0833333333333333*b1*c1*(-0.0833333333333333*E45*b2*c2 + 0.0833333333333333*E55*a2*c2)/Ac + 0.0833333333333333*b1*d1*(-0.0833333333333333*E44*b2*c2 + 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i4*dof+2] += 0.166666666666667*a2*(-0.0833333333333333*E45*b2*c2 + 0.0833333333333333*E55*a2*c2)/Ac - 0.166666666666667*b2*(-0.0833333333333333*E44*b2*c2 + 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i4*dof+3] += 0.0833333333333333*a2*c2*(-0.0833333333333333*E45*b2*c2 + 0.0833333333333333*E55*a2*c2)/Ac - 0.0833333333333333*b2*c2*(-0.0833333333333333*E44*b2*c2 + 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i4*dof+4] += 0.0833333333333333*a2*d2*(-0.0833333333333333*E45*b2*c2 + 0.0833333333333333*E55*a2*c2)/Ac - 0.0833333333333333*b2*d2*(-0.0833333333333333*E44*b2*c2 + 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+4, i1*dof+2] += (Ac1*(-0.166666666666667*c1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(0.166666666666667*a2/Ac2 + (-a2 + c2)/(2*Ac2)))*(-0.0833333333333333*E45*b2*d2 + 0.0833333333333333*E55*a2*d2)/Ac + (Ac1*(0.166666666666667*d1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(-0.166666666666667*b2/Ac2 + (b2 - d2)/(2*Ac2)))*(-0.0833333333333333*E44*b2*d2 + 0.0833333333333333*E45*a2*d2)/Ac
    k0[i4*dof+4, i1*dof+3] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(-0.0833333333333333*E44*b2*d2 + 0.0833333333333333*E45*a2*d2)/Ac + (-0.0833333333333333*a1*c1 + 0.0833333333333333*a2*c2)*(-0.0833333333333333*E45*b2*d2 + 0.0833333333333333*E55*a2*d2)/Ac
    k0[i4*dof+4, i1*dof+4] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(-0.0833333333333333*E45*b2*d2 + 0.0833333333333333*E55*a2*d2)/Ac + (0.0833333333333333*b1*d1 - 0.0833333333333333*b2*d2)*(-0.0833333333333333*E44*b2*d2 + 0.0833333333333333*E45*a2*d2)/Ac
    k0[i4*dof+4, i2*dof+2] += (Ac1*(a1/(2*Ac1) - 0.166666666666667*c1/Ac1) + Ac2*(0.166666666666667*a2/Ac2 - c2/(2*Ac2)))*(-0.0833333333333333*E45*b2*d2 + 0.0833333333333333*E55*a2*d2)/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*d1/Ac1) + Ac2*(-0.166666666666667*b2/Ac2 + d2/(2*Ac2)))*(-0.0833333333333333*E44*b2*d2 + 0.0833333333333333*E45*a2*d2)/Ac
    k0[i4*dof+4, i2*dof+3] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(-0.0833333333333333*E44*b2*d2 + 0.0833333333333333*E45*a2*d2)/Ac + (0.166666666666667*a1*c1 - 0.166666666666667*a2*c2)*(-0.0833333333333333*E45*b2*d2 + 0.0833333333333333*E55*a2*d2)/Ac
    k0[i4*dof+4, i2*dof+4] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(-0.0833333333333333*E45*b2*d2 + 0.0833333333333333*E55*a2*d2)/Ac + (-0.166666666666667*b1*d1 + 0.166666666666667*b2*d2)*(-0.0833333333333333*E44*b2*d2 + 0.0833333333333333*E45*a2*d2)/Ac
    k0[i4*dof+4, i3*dof+2] += -0.166666666666667*c1*(-0.0833333333333333*E45*b2*d2 + 0.0833333333333333*E55*a2*d2)/Ac + 0.166666666666667*d1*(-0.0833333333333333*E44*b2*d2 + 0.0833333333333333*E45*a2*d2)/Ac
    k0[i4*dof+4, i3*dof+3] += -0.0833333333333333*a1*c1*(-0.0833333333333333*E45*b2*d2 + 0.0833333333333333*E55*a2*d2)/Ac + 0.0833333333333333*a1*d1*(-0.0833333333333333*E44*b2*d2 + 0.0833333333333333*E45*a2*d2)/Ac
    k0[i4*dof+4, i3*dof+4] += -0.0833333333333333*b1*c1*(-0.0833333333333333*E45*b2*d2 + 0.0833333333333333*E55*a2*d2)/Ac + 0.0833333333333333*b1*d1*(-0.0833333333333333*E44*b2*d2 + 0.0833333333333333*E45*a2*d2)/Ac
    k0[i4*dof+4, i4*dof+2] += 0.166666666666667*a2*(-0.0833333333333333*E45*b2*d2 + 0.0833333333333333*E55*a2*d2)/Ac - 0.166666666666667*b2*(-0.0833333333333333*E44*b2*d2 + 0.0833333333333333*E45*a2*d2)/Ac
    k0[i4*dof+4, i4*dof+3] += 0.0833333333333333*a2*c2*(-0.0833333333333333*E45*b2*d2 + 0.0833333333333333*E55*a2*d2)/Ac - 0.0833333333333333*b2*c2*(-0.0833333333333333*E44*b2*d2 + 0.0833333333333333*E45*a2*d2)/Ac
    k0[i4*dof+4, i4*dof+4] += 0.0833333333333333*a2*d2*(-0.0833333333333333*E45*b2*d2 + 0.0833333333333333*E55*a2*d2)/Ac - 0.0833333333333333*b2*d2*(-0.0833333333333333*E44*b2*d2 + 0.0833333333333333*E45*a2*d2)/Ac


def interior_edge_tria1_n1n2mid1(k0, edge, prop_from_node):
    # sub-tria1: n1 -> mid2 -> n2
    # sub-tria2: n1 -> n2 -> mid1
    tria1 = edge.trias[0]
    tria2 = edge.trias[1]
    mid1 = getMid(tria1)
    mid2 = getMid(tria2)

    n1 = edge.n1
    n2 = edge.n2

    Ac = edge.Ac
    i1 = n1.index
    i2 = n2.index
    i3 = edge.othernode1.index
    i4 = edge.othernode2.index

    # sub-tria 1
    tmp = np.array([n1.xyz, n2.xyz, mid1])
    Ac1 = area_of_polygon(tmp[:, 0], tmp[:, 1])
    x1, y1, z1 = n1.xyz
    x2, y2, z2 = n2.xyz
    x3, y3, z3 = mid1
    a1 = x2 - x1
    b1 = y2 - y1
    c1 = x3 - x1
    d1 = y3 - y1

    tmp = np.array([n1.xyz, mid2, n2.xyz])
    Ac2 = area_of_polygon(tmp[:, 0], tmp[:, 1])
    x1, y1, z1 = n1.xyz
    x2, y2, z2 = mid2
    x3, y3, z3 = n2.xyz
    a2 = x2 - x1
    b2 = y2 - y1
    c2 = x3 - x1
    d2 = y3 - y1

    k = 5/6
    if prop_from_node:
        pn1 = n1.prop
        pn2 = n2.prop
        po1 = edge.othernode1.prop
        po2 = edge.othernode2.prop
        E = k*(5/12*pn1.E + 5/12*pn2.E + 1/12*po1.E + 1/12*po2.E)
    else:
        prop1 = tria1.prop
        prop2 = tria2.prop
        E = k*(Ac1*prop1.E + Ac2*prop2.E)/Ac

    E44 = E[0, 0]
    E45 = E[0, 1]
    E55 = E[1, 1]

    k0[i1*dof+2, i1*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2)))*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2)))*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+2, i1*dof+3] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + (E45*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2)/Ac
    k0[i1*dof+2, i1*dof+4] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + (E44*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2)/Ac
    k0[i1*dof+2, i2*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2))*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2))*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+2, i2*dof+3] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + (E45*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2)/Ac
    k0[i1*dof+2, i2*dof+4] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + (E44*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2)/Ac
    k0[i1*dof+2, i3*dof+2] += 0.166666666666667*a1*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac - 0.166666666666667*b1*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+2, i3*dof+3] += 0.0833333333333333*a1*c1*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac - 0.0833333333333333*b1*c1*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+2, i3*dof+4] += 0.0833333333333333*a1*d1*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac - 0.0833333333333333*b1*d1*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+2, i4*dof+2] += -0.166666666666667*c2*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + 0.166666666666667*d2*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+2, i4*dof+3] += -0.0833333333333333*a2*c2*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + 0.0833333333333333*a2*d2*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+2, i4*dof+4] += -0.0833333333333333*b2*c2*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E55*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac + 0.0833333333333333*b2*d2*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2))) + E45*(Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2))))/Ac
    k0[i1*dof+3, i1*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2)))*(E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E55*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2)))*(E44*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E45*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+3, i1*dof+3] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(E44*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E45*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac + (E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E55*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2)/Ac
    k0[i1*dof+3, i1*dof+4] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E55*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac + (E44*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E45*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2)/Ac
    k0[i1*dof+3, i2*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2))*(E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E55*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2))*(E44*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E45*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+3, i2*dof+3] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(E44*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E45*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac + (E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E55*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2)/Ac
    k0[i1*dof+3, i2*dof+4] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E55*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac + (E44*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E45*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2)/Ac
    k0[i1*dof+3, i3*dof+2] += 0.166666666666667*a1*(E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E55*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac - 0.166666666666667*b1*(E44*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E45*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+3, i3*dof+3] += 0.0833333333333333*a1*c1*(E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E55*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac - 0.0833333333333333*b1*c1*(E44*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E45*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+3, i3*dof+4] += 0.0833333333333333*a1*d1*(E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E55*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac - 0.0833333333333333*b1*d1*(E44*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E45*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+3, i4*dof+2] += -0.166666666666667*c2*(E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E55*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac + 0.166666666666667*d2*(E44*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E45*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+3, i4*dof+3] += -0.0833333333333333*a2*c2*(E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E55*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac + 0.0833333333333333*a2*d2*(E44*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E45*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+3, i4*dof+4] += -0.0833333333333333*b2*c2*(E45*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E55*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac + 0.0833333333333333*b2*d2*(E44*(Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2)) + E45*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2))/Ac
    k0[i1*dof+4, i1*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2)))*(E45*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2)))*(E44*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i1*dof+4, i1*dof+3] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(E44*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac + (E45*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2)/Ac
    k0[i1*dof+4, i1*dof+4] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(E45*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac + (E44*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2)/Ac
    k0[i1*dof+4, i2*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2))*(E45*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2))*(E44*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i1*dof+4, i2*dof+3] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(E44*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac + (E45*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2)/Ac
    k0[i1*dof+4, i2*dof+4] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(E45*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac + (E44*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2)/Ac
    k0[i1*dof+4, i3*dof+2] += 0.166666666666667*a1*(E45*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac - 0.166666666666667*b1*(E44*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i1*dof+4, i3*dof+3] += 0.0833333333333333*a1*c1*(E45*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac - 0.0833333333333333*b1*c1*(E44*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i1*dof+4, i3*dof+4] += 0.0833333333333333*a1*d1*(E45*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac - 0.0833333333333333*b1*d1*(E44*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i1*dof+4, i4*dof+2] += -0.166666666666667*c2*(E45*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac + 0.166666666666667*d2*(E44*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i1*dof+4, i4*dof+3] += -0.0833333333333333*a2*c2*(E45*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac + 0.0833333333333333*a2*d2*(E44*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i1*dof+4, i4*dof+4] += -0.0833333333333333*b2*c2*(E45*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E55*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac + 0.0833333333333333*b2*d2*(E44*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2) + E45*(Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i2*dof+2, i1*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2)))*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E55*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2)))*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E45*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac
    k0[i2*dof+2, i1*dof+3] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E45*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac + (E45*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E55*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2)/Ac
    k0[i2*dof+2, i1*dof+4] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E55*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac + (E44*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E45*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2)/Ac
    k0[i2*dof+2, i2*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2))*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E55*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2))*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E45*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac
    k0[i2*dof+2, i2*dof+3] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E45*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac + (E45*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E55*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2)/Ac
    k0[i2*dof+2, i2*dof+4] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E55*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac + (E44*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E45*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2)/Ac
    k0[i2*dof+2, i3*dof+2] += 0.166666666666667*a1*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E55*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac - 0.166666666666667*b1*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E45*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac
    k0[i2*dof+2, i3*dof+3] += 0.0833333333333333*a1*c1*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E55*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac - 0.0833333333333333*b1*c1*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E45*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac
    k0[i2*dof+2, i3*dof+4] += 0.0833333333333333*a1*d1*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E55*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac - 0.0833333333333333*b1*d1*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E45*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac
    k0[i2*dof+2, i4*dof+2] += -0.166666666666667*c2*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E55*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac + 0.166666666666667*d2*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E45*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac
    k0[i2*dof+2, i4*dof+3] += -0.0833333333333333*a2*c2*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E55*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac + 0.0833333333333333*a2*d2*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E45*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac
    k0[i2*dof+2, i4*dof+4] += -0.0833333333333333*b2*c2*(E45*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E55*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac + 0.0833333333333333*b2*d2*(E44*(Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2)) + E45*(Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2)))/Ac
    k0[i2*dof+3, i1*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2)))*(E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E55*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2)))*(E44*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E45*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+3, i1*dof+3] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(E44*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E45*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac + (E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E55*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2)/Ac
    k0[i2*dof+3, i1*dof+4] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E55*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac + (E44*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E45*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2)/Ac
    k0[i2*dof+3, i2*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2))*(E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E55*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2))*(E44*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E45*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+3, i2*dof+3] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(E44*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E45*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac + (E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E55*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2)/Ac
    k0[i2*dof+3, i2*dof+4] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E55*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac + (E44*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E45*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2)/Ac
    k0[i2*dof+3, i3*dof+2] += 0.166666666666667*a1*(E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E55*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac - 0.166666666666667*b1*(E44*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E45*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+3, i3*dof+3] += 0.0833333333333333*a1*c1*(E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E55*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac - 0.0833333333333333*b1*c1*(E44*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E45*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+3, i3*dof+4] += 0.0833333333333333*a1*d1*(E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E55*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac - 0.0833333333333333*b1*d1*(E44*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E45*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+3, i4*dof+2] += -0.166666666666667*c2*(E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E55*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac + 0.166666666666667*d2*(E44*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E45*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+3, i4*dof+3] += -0.0833333333333333*a2*c2*(E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E55*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac + 0.0833333333333333*a2*d2*(E44*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E45*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+3, i4*dof+4] += -0.0833333333333333*b2*c2*(E45*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E55*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac + 0.0833333333333333*b2*d2*(E44*(Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2))) + E45*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2))/Ac
    k0[i2*dof+4, i1*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2)))*(E45*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E55*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2)))*(E44*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i2*dof+4, i1*dof+3] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(E44*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac + (E45*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E55*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2)/Ac
    k0[i2*dof+4, i1*dof+4] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(E45*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E55*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac + (E44*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2)/Ac
    k0[i2*dof+4, i2*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2))*(E45*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E55*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2))*(E44*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i2*dof+4, i2*dof+3] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(E44*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac + (E45*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E55*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2)/Ac
    k0[i2*dof+4, i2*dof+4] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(E45*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E55*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac + (E44*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2)/Ac
    k0[i2*dof+4, i3*dof+2] += 0.166666666666667*a1*(E45*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E55*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac - 0.166666666666667*b1*(E44*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i2*dof+4, i3*dof+3] += 0.0833333333333333*a1*c1*(E45*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E55*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac - 0.0833333333333333*b1*c1*(E44*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i2*dof+4, i3*dof+4] += 0.0833333333333333*a1*d1*(E45*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E55*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac - 0.0833333333333333*b1*d1*(E44*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i2*dof+4, i4*dof+2] += -0.166666666666667*c2*(E45*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E55*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac + 0.166666666666667*d2*(E44*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i2*dof+4, i4*dof+3] += -0.0833333333333333*a2*c2*(E45*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E55*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac + 0.0833333333333333*a2*d2*(E44*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i2*dof+4, i4*dof+4] += -0.0833333333333333*b2*c2*(E45*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E55*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac + 0.0833333333333333*b2*d2*(E44*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2) + E45*(Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2)))/Ac
    k0[i3*dof+2, i1*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2)))*(-0.166666666666667*E45*b1 + 0.166666666666667*E55*a1)/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2)))*(-0.166666666666667*E44*b1 + 0.166666666666667*E45*a1)/Ac
    k0[i3*dof+2, i1*dof+3] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(-0.166666666666667*E44*b1 + 0.166666666666667*E45*a1)/Ac + (-0.166666666666667*E45*b1 + 0.166666666666667*E55*a1)*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2)/Ac
    k0[i3*dof+2, i1*dof+4] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(-0.166666666666667*E45*b1 + 0.166666666666667*E55*a1)/Ac + (-0.166666666666667*E44*b1 + 0.166666666666667*E45*a1)*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2)/Ac
    k0[i3*dof+2, i2*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2))*(-0.166666666666667*E45*b1 + 0.166666666666667*E55*a1)/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2))*(-0.166666666666667*E44*b1 + 0.166666666666667*E45*a1)/Ac
    k0[i3*dof+2, i2*dof+3] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(-0.166666666666667*E44*b1 + 0.166666666666667*E45*a1)/Ac + (-0.166666666666667*E45*b1 + 0.166666666666667*E55*a1)*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2)/Ac
    k0[i3*dof+2, i2*dof+4] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(-0.166666666666667*E45*b1 + 0.166666666666667*E55*a1)/Ac + (-0.166666666666667*E44*b1 + 0.166666666666667*E45*a1)*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2)/Ac
    k0[i3*dof+2, i3*dof+2] += 0.166666666666667*a1*(-0.166666666666667*E45*b1 + 0.166666666666667*E55*a1)/Ac - 0.166666666666667*b1*(-0.166666666666667*E44*b1 + 0.166666666666667*E45*a1)/Ac
    k0[i3*dof+2, i3*dof+3] += 0.0833333333333333*a1*c1*(-0.166666666666667*E45*b1 + 0.166666666666667*E55*a1)/Ac - 0.0833333333333333*b1*c1*(-0.166666666666667*E44*b1 + 0.166666666666667*E45*a1)/Ac
    k0[i3*dof+2, i3*dof+4] += 0.0833333333333333*a1*d1*(-0.166666666666667*E45*b1 + 0.166666666666667*E55*a1)/Ac - 0.0833333333333333*b1*d1*(-0.166666666666667*E44*b1 + 0.166666666666667*E45*a1)/Ac
    k0[i3*dof+2, i4*dof+2] += -0.166666666666667*c2*(-0.166666666666667*E45*b1 + 0.166666666666667*E55*a1)/Ac + 0.166666666666667*d2*(-0.166666666666667*E44*b1 + 0.166666666666667*E45*a1)/Ac
    k0[i3*dof+2, i4*dof+3] += -0.0833333333333333*a2*c2*(-0.166666666666667*E45*b1 + 0.166666666666667*E55*a1)/Ac + 0.0833333333333333*a2*d2*(-0.166666666666667*E44*b1 + 0.166666666666667*E45*a1)/Ac
    k0[i3*dof+2, i4*dof+4] += -0.0833333333333333*b2*c2*(-0.166666666666667*E45*b1 + 0.166666666666667*E55*a1)/Ac + 0.0833333333333333*b2*d2*(-0.166666666666667*E44*b1 + 0.166666666666667*E45*a1)/Ac
    k0[i3*dof+3, i1*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2)))*(-0.0833333333333333*E45*b1*c1 + 0.0833333333333333*E55*a1*c1)/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2)))*(-0.0833333333333333*E44*b1*c1 + 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i1*dof+3] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(-0.0833333333333333*E44*b1*c1 + 0.0833333333333333*E45*a1*c1)/Ac + (0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2)*(-0.0833333333333333*E45*b1*c1 + 0.0833333333333333*E55*a1*c1)/Ac
    k0[i3*dof+3, i1*dof+4] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(-0.0833333333333333*E45*b1*c1 + 0.0833333333333333*E55*a1*c1)/Ac + (-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2)*(-0.0833333333333333*E44*b1*c1 + 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i2*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2))*(-0.0833333333333333*E45*b1*c1 + 0.0833333333333333*E55*a1*c1)/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2))*(-0.0833333333333333*E44*b1*c1 + 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i2*dof+3] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(-0.0833333333333333*E44*b1*c1 + 0.0833333333333333*E45*a1*c1)/Ac + (-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2)*(-0.0833333333333333*E45*b1*c1 + 0.0833333333333333*E55*a1*c1)/Ac
    k0[i3*dof+3, i2*dof+4] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(-0.0833333333333333*E45*b1*c1 + 0.0833333333333333*E55*a1*c1)/Ac + (0.166666666666667*b1*d1 - 0.166666666666667*b2*d2)*(-0.0833333333333333*E44*b1*c1 + 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i3*dof+2] += 0.166666666666667*a1*(-0.0833333333333333*E45*b1*c1 + 0.0833333333333333*E55*a1*c1)/Ac - 0.166666666666667*b1*(-0.0833333333333333*E44*b1*c1 + 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i3*dof+3] += 0.0833333333333333*a1*c1*(-0.0833333333333333*E45*b1*c1 + 0.0833333333333333*E55*a1*c1)/Ac - 0.0833333333333333*b1*c1*(-0.0833333333333333*E44*b1*c1 + 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i3*dof+4] += 0.0833333333333333*a1*d1*(-0.0833333333333333*E45*b1*c1 + 0.0833333333333333*E55*a1*c1)/Ac - 0.0833333333333333*b1*d1*(-0.0833333333333333*E44*b1*c1 + 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i4*dof+2] += -0.166666666666667*c2*(-0.0833333333333333*E45*b1*c1 + 0.0833333333333333*E55*a1*c1)/Ac + 0.166666666666667*d2*(-0.0833333333333333*E44*b1*c1 + 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i4*dof+3] += -0.0833333333333333*a2*c2*(-0.0833333333333333*E45*b1*c1 + 0.0833333333333333*E55*a1*c1)/Ac + 0.0833333333333333*a2*d2*(-0.0833333333333333*E44*b1*c1 + 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+3, i4*dof+4] += -0.0833333333333333*b2*c2*(-0.0833333333333333*E45*b1*c1 + 0.0833333333333333*E55*a1*c1)/Ac + 0.0833333333333333*b2*d2*(-0.0833333333333333*E44*b1*c1 + 0.0833333333333333*E45*a1*c1)/Ac
    k0[i3*dof+4, i1*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2)))*(-0.0833333333333333*E45*b1*d1 + 0.0833333333333333*E55*a1*d1)/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2)))*(-0.0833333333333333*E44*b1*d1 + 0.0833333333333333*E45*a1*d1)/Ac
    k0[i3*dof+4, i1*dof+3] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(-0.0833333333333333*E44*b1*d1 + 0.0833333333333333*E45*a1*d1)/Ac + (0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2)*(-0.0833333333333333*E45*b1*d1 + 0.0833333333333333*E55*a1*d1)/Ac
    k0[i3*dof+4, i1*dof+4] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(-0.0833333333333333*E45*b1*d1 + 0.0833333333333333*E55*a1*d1)/Ac + (-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2)*(-0.0833333333333333*E44*b1*d1 + 0.0833333333333333*E45*a1*d1)/Ac
    k0[i3*dof+4, i2*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2))*(-0.0833333333333333*E45*b1*d1 + 0.0833333333333333*E55*a1*d1)/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2))*(-0.0833333333333333*E44*b1*d1 + 0.0833333333333333*E45*a1*d1)/Ac
    k0[i3*dof+4, i2*dof+3] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(-0.0833333333333333*E44*b1*d1 + 0.0833333333333333*E45*a1*d1)/Ac + (-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2)*(-0.0833333333333333*E45*b1*d1 + 0.0833333333333333*E55*a1*d1)/Ac
    k0[i3*dof+4, i2*dof+4] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(-0.0833333333333333*E45*b1*d1 + 0.0833333333333333*E55*a1*d1)/Ac + (0.166666666666667*b1*d1 - 0.166666666666667*b2*d2)*(-0.0833333333333333*E44*b1*d1 + 0.0833333333333333*E45*a1*d1)/Ac
    k0[i3*dof+4, i3*dof+2] += 0.166666666666667*a1*(-0.0833333333333333*E45*b1*d1 + 0.0833333333333333*E55*a1*d1)/Ac - 0.166666666666667*b1*(-0.0833333333333333*E44*b1*d1 + 0.0833333333333333*E45*a1*d1)/Ac
    k0[i3*dof+4, i3*dof+3] += 0.0833333333333333*a1*c1*(-0.0833333333333333*E45*b1*d1 + 0.0833333333333333*E55*a1*d1)/Ac - 0.0833333333333333*b1*c1*(-0.0833333333333333*E44*b1*d1 + 0.0833333333333333*E45*a1*d1)/Ac
    k0[i3*dof+4, i3*dof+4] += 0.0833333333333333*a1*d1*(-0.0833333333333333*E45*b1*d1 + 0.0833333333333333*E55*a1*d1)/Ac - 0.0833333333333333*b1*d1*(-0.0833333333333333*E44*b1*d1 + 0.0833333333333333*E45*a1*d1)/Ac
    k0[i3*dof+4, i4*dof+2] += -0.166666666666667*c2*(-0.0833333333333333*E45*b1*d1 + 0.0833333333333333*E55*a1*d1)/Ac + 0.166666666666667*d2*(-0.0833333333333333*E44*b1*d1 + 0.0833333333333333*E45*a1*d1)/Ac
    k0[i3*dof+4, i4*dof+3] += -0.0833333333333333*a2*c2*(-0.0833333333333333*E45*b1*d1 + 0.0833333333333333*E55*a1*d1)/Ac + 0.0833333333333333*a2*d2*(-0.0833333333333333*E44*b1*d1 + 0.0833333333333333*E45*a1*d1)/Ac
    k0[i3*dof+4, i4*dof+4] += -0.0833333333333333*b2*c2*(-0.0833333333333333*E45*b1*d1 + 0.0833333333333333*E55*a1*d1)/Ac + 0.0833333333333333*b2*d2*(-0.0833333333333333*E44*b1*d1 + 0.0833333333333333*E45*a1*d1)/Ac
    k0[i4*dof+2, i1*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2)))*(0.166666666666667*E45*d2 - 0.166666666666667*E55*c2)/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2)))*(0.166666666666667*E44*d2 - 0.166666666666667*E45*c2)/Ac
    k0[i4*dof+2, i1*dof+3] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(0.166666666666667*E44*d2 - 0.166666666666667*E45*c2)/Ac + (0.166666666666667*E45*d2 - 0.166666666666667*E55*c2)*(0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2)/Ac
    k0[i4*dof+2, i1*dof+4] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(0.166666666666667*E45*d2 - 0.166666666666667*E55*c2)/Ac + (0.166666666666667*E44*d2 - 0.166666666666667*E45*c2)*(-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2)/Ac
    k0[i4*dof+2, i2*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2))*(0.166666666666667*E45*d2 - 0.166666666666667*E55*c2)/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2))*(0.166666666666667*E44*d2 - 0.166666666666667*E45*c2)/Ac
    k0[i4*dof+2, i2*dof+3] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(0.166666666666667*E44*d2 - 0.166666666666667*E45*c2)/Ac + (0.166666666666667*E45*d2 - 0.166666666666667*E55*c2)*(-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2)/Ac
    k0[i4*dof+2, i2*dof+4] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(0.166666666666667*E45*d2 - 0.166666666666667*E55*c2)/Ac + (0.166666666666667*E44*d2 - 0.166666666666667*E45*c2)*(0.166666666666667*b1*d1 - 0.166666666666667*b2*d2)/Ac
    k0[i4*dof+2, i3*dof+2] += 0.166666666666667*a1*(0.166666666666667*E45*d2 - 0.166666666666667*E55*c2)/Ac - 0.166666666666667*b1*(0.166666666666667*E44*d2 - 0.166666666666667*E45*c2)/Ac
    k0[i4*dof+2, i3*dof+3] += 0.0833333333333333*a1*c1*(0.166666666666667*E45*d2 - 0.166666666666667*E55*c2)/Ac - 0.0833333333333333*b1*c1*(0.166666666666667*E44*d2 - 0.166666666666667*E45*c2)/Ac
    k0[i4*dof+2, i3*dof+4] += 0.0833333333333333*a1*d1*(0.166666666666667*E45*d2 - 0.166666666666667*E55*c2)/Ac - 0.0833333333333333*b1*d1*(0.166666666666667*E44*d2 - 0.166666666666667*E45*c2)/Ac
    k0[i4*dof+2, i4*dof+2] += -0.166666666666667*c2*(0.166666666666667*E45*d2 - 0.166666666666667*E55*c2)/Ac + 0.166666666666667*d2*(0.166666666666667*E44*d2 - 0.166666666666667*E45*c2)/Ac
    k0[i4*dof+2, i4*dof+3] += -0.0833333333333333*a2*c2*(0.166666666666667*E45*d2 - 0.166666666666667*E55*c2)/Ac + 0.0833333333333333*a2*d2*(0.166666666666667*E44*d2 - 0.166666666666667*E45*c2)/Ac
    k0[i4*dof+2, i4*dof+4] += -0.0833333333333333*b2*c2*(0.166666666666667*E45*d2 - 0.166666666666667*E55*c2)/Ac + 0.0833333333333333*b2*d2*(0.166666666666667*E44*d2 - 0.166666666666667*E45*c2)/Ac
    k0[i4*dof+3, i1*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2)))*(0.0833333333333333*E45*a2*d2 - 0.0833333333333333*E55*a2*c2)/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2)))*(0.0833333333333333*E44*a2*d2 - 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i1*dof+3] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(0.0833333333333333*E44*a2*d2 - 0.0833333333333333*E45*a2*c2)/Ac + (0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2)*(0.0833333333333333*E45*a2*d2 - 0.0833333333333333*E55*a2*c2)/Ac
    k0[i4*dof+3, i1*dof+4] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(0.0833333333333333*E45*a2*d2 - 0.0833333333333333*E55*a2*c2)/Ac + (-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2)*(0.0833333333333333*E44*a2*d2 - 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i2*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2))*(0.0833333333333333*E45*a2*d2 - 0.0833333333333333*E55*a2*c2)/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2))*(0.0833333333333333*E44*a2*d2 - 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i2*dof+3] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(0.0833333333333333*E44*a2*d2 - 0.0833333333333333*E45*a2*c2)/Ac + (-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2)*(0.0833333333333333*E45*a2*d2 - 0.0833333333333333*E55*a2*c2)/Ac
    k0[i4*dof+3, i2*dof+4] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(0.0833333333333333*E45*a2*d2 - 0.0833333333333333*E55*a2*c2)/Ac + (0.166666666666667*b1*d1 - 0.166666666666667*b2*d2)*(0.0833333333333333*E44*a2*d2 - 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i3*dof+2] += 0.166666666666667*a1*(0.0833333333333333*E45*a2*d2 - 0.0833333333333333*E55*a2*c2)/Ac - 0.166666666666667*b1*(0.0833333333333333*E44*a2*d2 - 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i3*dof+3] += 0.0833333333333333*a1*c1*(0.0833333333333333*E45*a2*d2 - 0.0833333333333333*E55*a2*c2)/Ac - 0.0833333333333333*b1*c1*(0.0833333333333333*E44*a2*d2 - 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i3*dof+4] += 0.0833333333333333*a1*d1*(0.0833333333333333*E45*a2*d2 - 0.0833333333333333*E55*a2*c2)/Ac - 0.0833333333333333*b1*d1*(0.0833333333333333*E44*a2*d2 - 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i4*dof+2] += -0.166666666666667*c2*(0.0833333333333333*E45*a2*d2 - 0.0833333333333333*E55*a2*c2)/Ac + 0.166666666666667*d2*(0.0833333333333333*E44*a2*d2 - 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i4*dof+3] += -0.0833333333333333*a2*c2*(0.0833333333333333*E45*a2*d2 - 0.0833333333333333*E55*a2*c2)/Ac + 0.0833333333333333*a2*d2*(0.0833333333333333*E44*a2*d2 - 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+3, i4*dof+4] += -0.0833333333333333*b2*c2*(0.0833333333333333*E45*a2*d2 - 0.0833333333333333*E55*a2*c2)/Ac + 0.0833333333333333*b2*d2*(0.0833333333333333*E44*a2*d2 - 0.0833333333333333*E45*a2*c2)/Ac
    k0[i4*dof+4, i1*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 + (-a1 + c1)/(2*Ac1)) + Ac2*(-0.166666666666667*c2/Ac2 + (-a2 + c2)/(2*Ac2)))*(0.0833333333333333*E45*b2*d2 - 0.0833333333333333*E55*b2*c2)/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + (b1 - d1)/(2*Ac1)) + Ac2*(0.166666666666667*d2/Ac2 + (b2 - d2)/(2*Ac2)))*(0.0833333333333333*E44*b2*d2 - 0.0833333333333333*E45*b2*c2)/Ac
    k0[i4*dof+4, i1*dof+3] += (Ac1*(1/2 - 0.0833333333333333*b1*c1/Ac1) + Ac2*(1/2 + 0.0833333333333333*a2*d2/Ac2))*(0.0833333333333333*E44*b2*d2 - 0.0833333333333333*E45*b2*c2)/Ac + (0.0833333333333333*a1*c1 - 0.0833333333333333*a2*c2)*(0.0833333333333333*E45*b2*d2 - 0.0833333333333333*E55*b2*c2)/Ac
    k0[i4*dof+4, i1*dof+4] += (Ac1*(1/2 + 0.0833333333333333*a1*d1/Ac1) + Ac2*(1/2 - 0.0833333333333333*b2*c2/Ac2))*(0.0833333333333333*E45*b2*d2 - 0.0833333333333333*E55*b2*c2)/Ac + (-0.0833333333333333*b1*d1 + 0.0833333333333333*b2*d2)*(0.0833333333333333*E44*b2*d2 - 0.0833333333333333*E45*b2*c2)/Ac
    k0[i4*dof+4, i2*dof+2] += (Ac1*(0.166666666666667*a1/Ac1 - c1/(2*Ac1)) + Ac2*(a2/(2*Ac2) - 0.166666666666667*c2/Ac2))*(0.0833333333333333*E45*b2*d2 - 0.0833333333333333*E55*b2*c2)/Ac + (Ac1*(-0.166666666666667*b1/Ac1 + d1/(2*Ac1)) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*d2/Ac2))*(0.0833333333333333*E44*b2*d2 - 0.0833333333333333*E45*b2*c2)/Ac
    k0[i4*dof+4, i2*dof+3] += (Ac1*(a1*d1/(4*Ac1) - 0.0833333333333333*b1*c1/Ac1) + Ac2*(0.0833333333333333*a2*d2/Ac2 - b2*c2/(4*Ac2)))*(0.0833333333333333*E44*b2*d2 - 0.0833333333333333*E45*b2*c2)/Ac + (-0.166666666666667*a1*c1 + 0.166666666666667*a2*c2)*(0.0833333333333333*E45*b2*d2 - 0.0833333333333333*E55*b2*c2)/Ac
    k0[i4*dof+4, i2*dof+4] += (Ac1*(0.0833333333333333*a1*d1/Ac1 - b1*c1/(4*Ac1)) + Ac2*(a2*d2/(4*Ac2) - 0.0833333333333333*b2*c2/Ac2))*(0.0833333333333333*E45*b2*d2 - 0.0833333333333333*E55*b2*c2)/Ac + (0.166666666666667*b1*d1 - 0.166666666666667*b2*d2)*(0.0833333333333333*E44*b2*d2 - 0.0833333333333333*E45*b2*c2)/Ac
    k0[i4*dof+4, i3*dof+2] += 0.166666666666667*a1*(0.0833333333333333*E45*b2*d2 - 0.0833333333333333*E55*b2*c2)/Ac - 0.166666666666667*b1*(0.0833333333333333*E44*b2*d2 - 0.0833333333333333*E45*b2*c2)/Ac
    k0[i4*dof+4, i3*dof+3] += 0.0833333333333333*a1*c1*(0.0833333333333333*E45*b2*d2 - 0.0833333333333333*E55*b2*c2)/Ac - 0.0833333333333333*b1*c1*(0.0833333333333333*E44*b2*d2 - 0.0833333333333333*E45*b2*c2)/Ac
    k0[i4*dof+4, i3*dof+4] += 0.0833333333333333*a1*d1*(0.0833333333333333*E45*b2*d2 - 0.0833333333333333*E55*b2*c2)/Ac - 0.0833333333333333*b1*d1*(0.0833333333333333*E44*b2*d2 - 0.0833333333333333*E45*b2*c2)/Ac
    k0[i4*dof+4, i4*dof+2] += -0.166666666666667*c2*(0.0833333333333333*E45*b2*d2 - 0.0833333333333333*E55*b2*c2)/Ac + 0.166666666666667*d2*(0.0833333333333333*E44*b2*d2 - 0.0833333333333333*E45*b2*c2)/Ac
    k0[i4*dof+4, i4*dof+3] += -0.0833333333333333*a2*c2*(0.0833333333333333*E45*b2*d2 - 0.0833333333333333*E55*b2*c2)/Ac + 0.0833333333333333*a2*d2*(0.0833333333333333*E44*b2*d2 - 0.0833333333333333*E45*b2*c2)/Ac
    k0[i4*dof+4, i4*dof+4] += -0.0833333333333333*b2*c2*(0.0833333333333333*E45*b2*d2 - 0.0833333333333333*E55*b2*c2)/Ac + 0.0833333333333333*b2*d2*(0.0833333333333333*E44*b2*d2 - 0.0833333333333333*E45*b2*c2)/Ac


def add_k0s(k0, mesh, prop_from_node, silent=True):
    msg('Adding K0s to K0...', silent=silent)
    for edge in mesh.edges.values():
        n1 = edge.n1
        n2 = edge.n2
        mid1 = getMid(edge.trias[0])
        conn = 'tria1_n1mid1n2'
        if np.dot(np.cross((mid1 - n1.xyz), (n2.xyz - n1.xyz)), ZGLOBAL) < 0:
            conn = 'tria1_n1n2mid1'

        if len(edge.trias) == 1 and conn == 'tria1_n1mid1n2':
            boundary_edge_tria1_n1mid1n2(k0, edge, prop_from_node)
        elif len(edge.trias) == 1 and conn == 'tria1_n1n2mid1':
            boundary_edge_tria1_n1n2mid1(k0, edge, prop_from_node)
        elif len(edge.trias) == 2 and conn == 'tria1_n1mid1n2':
            interior_edge_tria1_n1mid1n2(k0, edge, prop_from_node)
        elif len(edge.trias) == 2 and conn == 'tria1_n1n2mid1':
            interior_edge_tria1_n1n2mid1(k0, edge, prop_from_node)
        else:
            raise NotImplementedError('')

    msg('finished!', silent=silent)
    return k0
