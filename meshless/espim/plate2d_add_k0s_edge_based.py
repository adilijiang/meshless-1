from __future__ import absolute_import, division

import numpy as np

from ..constants import ZGLOBAL
from .plate2d import area_of_polygon
from .read_mesh import getMid


def add_k0s(k0, edges, prop_from_node):
    print('Adding K0s to K0...')
    dof = 5
    for edge in edges:
        tria1 = edge.trias[0]
        mid1 = getMid(tria1)
        tmp = np.array([mid1, edge.n2.xyz, edge.n1.xyz])
        Ac1 = area_of_polygon(tmp[:, 0], tmp[:, 1])
        if len(edge.trias) == 1:
            tria2 = None
            mid2 = None
            Ac = Ac1
        elif len(edge.trias) == 2:
            tria2 = edge.trias[1]
            mid2 = getMid(tria2)
            tmp = np.array([mid2, edge.n1.xyz, edge.n2.xyz])
            Ac2 = area_of_polygon(tmp[:, 0], tmp[:, 1])
            Ac = Ac1 + Ac2
        else:
            raise RuntimeError('Found %d trias for edge' % len(edge.trias))
        indices = set()
        for ipt in edge.ipts:
            indices.add(ipt.n1.index)
            indices.add(ipt.n2.index)
            indices.add(ipt.n3.index)
        indices = sorted(list(indices))
        if len(edge.ipts) == 3:
            indices.append(-1) # fourth dummy index
        i1, i2, i3, i4 = indices

        # sub-tria1: mid1 -> n2 -> n1
        # sub-tria2: mid2 -> n1 -> n2

        n1 = edge.n1
        n2 = edge.n2
        if np.dot(np.cross((n2.xyz - mid1), (n1.xyz - mid1)), ZGLOBAL) < 0:
            n1, n2 = n2, n1

        # sub-tria 1
        x1, y1, z1 = mid1
        x2, y2, z2 = n2.xyz
        x3, y3, z3 = n1.xyz
        a1 = x2 - x1
        b1 = y2 - y1
        c1 = x3 - x1
        d1 = y3 - y1

        if tria2 is not None:
            i4 = edge.othernode2.index
            # sub-tria 2
            x1, y1, z1 = mid2
            x2, y2, z2 = n1.xyz
            x3, y3, z3 = n2.xyz
            a2 = x2 - x1
            b2 = y2 - y1
            c2 = x3 - x1
            d2 = y3 - y1
        else:
            a2 = 0
            b2 = 0
            c2 = 0
            d2 = 0
            Ac2 = 1
            i4 = i1

        i1 = n1.index
        i2 = n2.index
        i3 = edge.othernode1.index

        k = 5/6
        if prop_from_node:
            pn1 = edge.n1.prop
            pn2 = edge.n2.prop
            po1 = edge.othernode1.prop
            if tria2 is None:
                G = k*(4/9*pn1.E*pn1.t**2 + 4/9*pn2.E*pn2.t**2 + 1/9*po1.E*po1.t**2)
            else:
                po2 = edge.othernode2.prop
                G = k*(5/12*pn1.E*pn1.t**2 + 5/12*pn2.E*pn2.t**2 + 1/12*po1.E*po1.t**2 + 1/12*po2.E*po2.t**2)
        else:
            prop1 = tria1.prop
            if tria2 is None:
                G = k*prop1.E*prop1.t**2
            else:
                prop2 = tria2.prop
                G = k*(Ac1*prop1.E*prop1.t**2 + Ac2*prop2.E*prop2.t**2)/Ac

        G44 = G[0, 0]
        G45 = G[0, 1]
        G55 = G[1, 1]

        k0[i1*dof+2, i1*dof+2] += (Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i1*dof+2, i1*dof+3] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (G45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))*(a1*c1/4 - a2*c2/4)/Ac
        k0[i1*dof+2, i1*dof+4] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (G44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))*(-b1*d1/4 + b2*d2/4)/Ac
        k0[i1*dof+2, i2*dof+2] += (Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i1*dof+2, i2*dof+3] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (G45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))*(-a1*c1/4 + a2*c2/4)/Ac
        k0[i1*dof+2, i2*dof+4] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (G44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))*(b1*d1/4 - b2*d2/4)/Ac
        k0[i1*dof+2, i3*dof+2] += (-0.166666666666667*a1 + 0.166666666666667*c1)*(G45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (0.166666666666667*b1 - 0.166666666666667*d1)*(G44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i1*dof+2, i3*dof+3] += 0.166666666666667*Ac1*(G44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i1*dof+2, i3*dof+4] += 0.166666666666667*Ac1*(G45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i1*dof+2, i4*dof+2] += (-0.166666666666667*a2 + 0.166666666666667*c2)*(G45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (0.166666666666667*b2 - 0.166666666666667*d2)*(G44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i1*dof+2, i4*dof+3] += 0.166666666666667*Ac2*(G44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i1*dof+2, i4*dof+4] += 0.166666666666667*Ac2*(G45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i1*dof+3, i1*dof+2] += (Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G55*(a1*c1/4 - a2*c2/4))/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G45*(a1*c1/4 - a2*c2/4))/Ac
        k0[i1*dof+3, i1*dof+3] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G44*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G45*(a1*c1/4 - a2*c2/4))/Ac + (G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G55*(a1*c1/4 - a2*c2/4))*(a1*c1/4 - a2*c2/4)/Ac
        k0[i1*dof+3, i1*dof+4] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G55*(a1*c1/4 - a2*c2/4))/Ac + (G44*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G45*(a1*c1/4 - a2*c2/4))*(-b1*d1/4 + b2*d2/4)/Ac
        k0[i1*dof+3, i2*dof+2] += (Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G55*(a1*c1/4 - a2*c2/4))/Ac + (Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G45*(a1*c1/4 - a2*c2/4))/Ac
        k0[i1*dof+3, i2*dof+3] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G44*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G45*(a1*c1/4 - a2*c2/4))/Ac + (G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G55*(a1*c1/4 - a2*c2/4))*(-a1*c1/4 + a2*c2/4)/Ac
        k0[i1*dof+3, i2*dof+4] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G55*(a1*c1/4 - a2*c2/4))/Ac + (G44*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G45*(a1*c1/4 - a2*c2/4))*(b1*d1/4 - b2*d2/4)/Ac
        k0[i1*dof+3, i3*dof+2] += (-0.166666666666667*a1 + 0.166666666666667*c1)*(G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G55*(a1*c1/4 - a2*c2/4))/Ac + (0.166666666666667*b1 - 0.166666666666667*d1)*(G44*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G45*(a1*c1/4 - a2*c2/4))/Ac
        k0[i1*dof+3, i3*dof+3] += 0.166666666666667*Ac1*(G44*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G45*(a1*c1/4 - a2*c2/4))/Ac
        k0[i1*dof+3, i3*dof+4] += 0.166666666666667*Ac1*(G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G55*(a1*c1/4 - a2*c2/4))/Ac
        k0[i1*dof+3, i4*dof+2] += (-0.166666666666667*a2 + 0.166666666666667*c2)*(G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G55*(a1*c1/4 - a2*c2/4))/Ac + (0.166666666666667*b2 - 0.166666666666667*d2)*(G44*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G45*(a1*c1/4 - a2*c2/4))/Ac
        k0[i1*dof+3, i4*dof+3] += 0.166666666666667*Ac2*(G44*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G45*(a1*c1/4 - a2*c2/4))/Ac
        k0[i1*dof+3, i4*dof+4] += 0.166666666666667*Ac2*(G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))) + G55*(a1*c1/4 - a2*c2/4))/Ac
        k0[i1*dof+4, i1*dof+2] += (Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(-b1*d1/4 + b2*d2/4) + G55*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(-b1*d1/4 + b2*d2/4) + G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac
        k0[i1*dof+4, i1*dof+3] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G44*(-b1*d1/4 + b2*d2/4) + G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac + (G45*(-b1*d1/4 + b2*d2/4) + G55*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))*(a1*c1/4 - a2*c2/4)/Ac
        k0[i1*dof+4, i1*dof+4] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G45*(-b1*d1/4 + b2*d2/4) + G55*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac + (G44*(-b1*d1/4 + b2*d2/4) + G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))*(-b1*d1/4 + b2*d2/4)/Ac
        k0[i1*dof+4, i2*dof+2] += (Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(-b1*d1/4 + b2*d2/4) + G55*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac + (Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(-b1*d1/4 + b2*d2/4) + G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac
        k0[i1*dof+4, i2*dof+3] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G44*(-b1*d1/4 + b2*d2/4) + G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac + (G45*(-b1*d1/4 + b2*d2/4) + G55*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))*(-a1*c1/4 + a2*c2/4)/Ac
        k0[i1*dof+4, i2*dof+4] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G45*(-b1*d1/4 + b2*d2/4) + G55*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac + (G44*(-b1*d1/4 + b2*d2/4) + G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))*(b1*d1/4 - b2*d2/4)/Ac
        k0[i1*dof+4, i3*dof+2] += (-0.166666666666667*a1 + 0.166666666666667*c1)*(G45*(-b1*d1/4 + b2*d2/4) + G55*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac + (0.166666666666667*b1 - 0.166666666666667*d1)*(G44*(-b1*d1/4 + b2*d2/4) + G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac
        k0[i1*dof+4, i3*dof+3] += 0.166666666666667*Ac1*(G44*(-b1*d1/4 + b2*d2/4) + G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac
        k0[i1*dof+4, i3*dof+4] += 0.166666666666667*Ac1*(G45*(-b1*d1/4 + b2*d2/4) + G55*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac
        k0[i1*dof+4, i4*dof+2] += (-0.166666666666667*a2 + 0.166666666666667*c2)*(G45*(-b1*d1/4 + b2*d2/4) + G55*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac + (0.166666666666667*b2 - 0.166666666666667*d2)*(G44*(-b1*d1/4 + b2*d2/4) + G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac
        k0[i1*dof+4, i4*dof+3] += 0.166666666666667*Ac2*(G44*(-b1*d1/4 + b2*d2/4) + G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac
        k0[i1*dof+4, i4*dof+4] += 0.166666666666667*Ac2*(G45*(-b1*d1/4 + b2*d2/4) + G55*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))))/Ac
        k0[i2*dof+2, i1*dof+2] += (Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i2*dof+2, i1*dof+3] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G44*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (G45*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))*(a1*c1/4 - a2*c2/4)/Ac
        k0[i2*dof+2, i1*dof+4] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G45*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (G44*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))*(-b1*d1/4 + b2*d2/4)/Ac
        k0[i2*dof+2, i2*dof+2] += (Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i2*dof+2, i2*dof+3] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G44*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (G45*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))*(-a1*c1/4 + a2*c2/4)/Ac
        k0[i2*dof+2, i2*dof+4] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G45*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (G44*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))*(b1*d1/4 - b2*d2/4)/Ac
        k0[i2*dof+2, i3*dof+2] += (-0.166666666666667*a1 + 0.166666666666667*c1)*(G45*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (0.166666666666667*b1 - 0.166666666666667*d1)*(G44*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i2*dof+2, i3*dof+3] += 0.166666666666667*Ac1*(G44*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i2*dof+2, i3*dof+4] += 0.166666666666667*Ac1*(G45*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i2*dof+2, i4*dof+2] += (-0.166666666666667*a2 + 0.166666666666667*c2)*(G45*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac + (0.166666666666667*b2 - 0.166666666666667*d2)*(G44*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i2*dof+2, i4*dof+3] += 0.166666666666667*Ac2*(G44*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G45*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i2*dof+2, i4*dof+4] += 0.166666666666667*Ac2*(G45*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2)) + G55*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2)))/Ac
        k0[i2*dof+3, i1*dof+2] += (Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G55*(-a1*c1/4 + a2*c2/4))/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G45*(-a1*c1/4 + a2*c2/4))/Ac
        k0[i2*dof+3, i1*dof+3] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G44*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G45*(-a1*c1/4 + a2*c2/4))/Ac + (G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G55*(-a1*c1/4 + a2*c2/4))*(a1*c1/4 - a2*c2/4)/Ac
        k0[i2*dof+3, i1*dof+4] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G55*(-a1*c1/4 + a2*c2/4))/Ac + (G44*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G45*(-a1*c1/4 + a2*c2/4))*(-b1*d1/4 + b2*d2/4)/Ac
        k0[i2*dof+3, i2*dof+2] += (Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G55*(-a1*c1/4 + a2*c2/4))/Ac + (Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G45*(-a1*c1/4 + a2*c2/4))/Ac
        k0[i2*dof+3, i2*dof+3] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G44*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G45*(-a1*c1/4 + a2*c2/4))/Ac + (G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G55*(-a1*c1/4 + a2*c2/4))*(-a1*c1/4 + a2*c2/4)/Ac
        k0[i2*dof+3, i2*dof+4] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G55*(-a1*c1/4 + a2*c2/4))/Ac + (G44*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G45*(-a1*c1/4 + a2*c2/4))*(b1*d1/4 - b2*d2/4)/Ac
        k0[i2*dof+3, i3*dof+2] += (-0.166666666666667*a1 + 0.166666666666667*c1)*(G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G55*(-a1*c1/4 + a2*c2/4))/Ac + (0.166666666666667*b1 - 0.166666666666667*d1)*(G44*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G45*(-a1*c1/4 + a2*c2/4))/Ac
        k0[i2*dof+3, i3*dof+3] += 0.166666666666667*Ac1*(G44*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G45*(-a1*c1/4 + a2*c2/4))/Ac
        k0[i2*dof+3, i3*dof+4] += 0.166666666666667*Ac1*(G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G55*(-a1*c1/4 + a2*c2/4))/Ac
        k0[i2*dof+3, i4*dof+2] += (-0.166666666666667*a2 + 0.166666666666667*c2)*(G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G55*(-a1*c1/4 + a2*c2/4))/Ac + (0.166666666666667*b2 - 0.166666666666667*d2)*(G44*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G45*(-a1*c1/4 + a2*c2/4))/Ac
        k0[i2*dof+3, i4*dof+3] += 0.166666666666667*Ac2*(G44*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G45*(-a1*c1/4 + a2*c2/4))/Ac
        k0[i2*dof+3, i4*dof+4] += 0.166666666666667*Ac2*(G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2))) + G55*(-a1*c1/4 + a2*c2/4))/Ac
        k0[i2*dof+4, i1*dof+2] += (Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(b1*d1/4 - b2*d2/4) + G55*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(b1*d1/4 - b2*d2/4) + G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac
        k0[i2*dof+4, i1*dof+3] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G44*(b1*d1/4 - b2*d2/4) + G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac + (G45*(b1*d1/4 - b2*d2/4) + G55*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))*(a1*c1/4 - a2*c2/4)/Ac
        k0[i2*dof+4, i1*dof+4] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G45*(b1*d1/4 - b2*d2/4) + G55*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac + (G44*(b1*d1/4 - b2*d2/4) + G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))*(-b1*d1/4 + b2*d2/4)/Ac
        k0[i2*dof+4, i2*dof+2] += (Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(b1*d1/4 - b2*d2/4) + G55*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac + (Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(b1*d1/4 - b2*d2/4) + G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac
        k0[i2*dof+4, i2*dof+3] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G44*(b1*d1/4 - b2*d2/4) + G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac + (G45*(b1*d1/4 - b2*d2/4) + G55*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))*(-a1*c1/4 + a2*c2/4)/Ac
        k0[i2*dof+4, i2*dof+4] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G45*(b1*d1/4 - b2*d2/4) + G55*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac + (G44*(b1*d1/4 - b2*d2/4) + G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))*(b1*d1/4 - b2*d2/4)/Ac
        k0[i2*dof+4, i3*dof+2] += (-0.166666666666667*a1 + 0.166666666666667*c1)*(G45*(b1*d1/4 - b2*d2/4) + G55*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac + (0.166666666666667*b1 - 0.166666666666667*d1)*(G44*(b1*d1/4 - b2*d2/4) + G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac
        k0[i2*dof+4, i3*dof+3] += 0.166666666666667*Ac1*(G44*(b1*d1/4 - b2*d2/4) + G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac
        k0[i2*dof+4, i3*dof+4] += 0.166666666666667*Ac1*(G45*(b1*d1/4 - b2*d2/4) + G55*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac
        k0[i2*dof+4, i4*dof+2] += (-0.166666666666667*a2 + 0.166666666666667*c2)*(G45*(b1*d1/4 - b2*d2/4) + G55*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac + (0.166666666666667*b2 - 0.166666666666667*d2)*(G44*(b1*d1/4 - b2*d2/4) + G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac
        k0[i2*dof+4, i4*dof+3] += 0.166666666666667*Ac2*(G44*(b1*d1/4 - b2*d2/4) + G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac
        k0[i2*dof+4, i4*dof+4] += 0.166666666666667*Ac2*(G45*(b1*d1/4 - b2*d2/4) + G55*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2))))/Ac
        k0[i3*dof+2, i1*dof+2] += (Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(0.166666666666667*b1 - 0.166666666666667*d1) + G55*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(0.166666666666667*b1 - 0.166666666666667*d1) + G45*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac
        k0[i3*dof+2, i1*dof+3] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G44*(0.166666666666667*b1 - 0.166666666666667*d1) + G45*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac + (G45*(0.166666666666667*b1 - 0.166666666666667*d1) + G55*(-0.166666666666667*a1 + 0.166666666666667*c1))*(a1*c1/4 - a2*c2/4)/Ac
        k0[i3*dof+2, i1*dof+4] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G45*(0.166666666666667*b1 - 0.166666666666667*d1) + G55*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac + (G44*(0.166666666666667*b1 - 0.166666666666667*d1) + G45*(-0.166666666666667*a1 + 0.166666666666667*c1))*(-b1*d1/4 + b2*d2/4)/Ac
        k0[i3*dof+2, i2*dof+2] += (Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(0.166666666666667*b1 - 0.166666666666667*d1) + G55*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac + (Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(0.166666666666667*b1 - 0.166666666666667*d1) + G45*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac
        k0[i3*dof+2, i2*dof+3] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G44*(0.166666666666667*b1 - 0.166666666666667*d1) + G45*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac + (G45*(0.166666666666667*b1 - 0.166666666666667*d1) + G55*(-0.166666666666667*a1 + 0.166666666666667*c1))*(-a1*c1/4 + a2*c2/4)/Ac
        k0[i3*dof+2, i2*dof+4] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G45*(0.166666666666667*b1 - 0.166666666666667*d1) + G55*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac + (G44*(0.166666666666667*b1 - 0.166666666666667*d1) + G45*(-0.166666666666667*a1 + 0.166666666666667*c1))*(b1*d1/4 - b2*d2/4)/Ac
        k0[i3*dof+2, i3*dof+2] += (-0.166666666666667*a1 + 0.166666666666667*c1)*(G45*(0.166666666666667*b1 - 0.166666666666667*d1) + G55*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac + (0.166666666666667*b1 - 0.166666666666667*d1)*(G44*(0.166666666666667*b1 - 0.166666666666667*d1) + G45*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac
        k0[i3*dof+2, i3*dof+3] += 0.166666666666667*Ac1*(G44*(0.166666666666667*b1 - 0.166666666666667*d1) + G45*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac
        k0[i3*dof+2, i3*dof+4] += 0.166666666666667*Ac1*(G45*(0.166666666666667*b1 - 0.166666666666667*d1) + G55*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac
        k0[i3*dof+2, i4*dof+2] += (-0.166666666666667*a2 + 0.166666666666667*c2)*(G45*(0.166666666666667*b1 - 0.166666666666667*d1) + G55*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac + (0.166666666666667*b2 - 0.166666666666667*d2)*(G44*(0.166666666666667*b1 - 0.166666666666667*d1) + G45*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac
        k0[i3*dof+2, i4*dof+3] += 0.166666666666667*Ac2*(G44*(0.166666666666667*b1 - 0.166666666666667*d1) + G45*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac
        k0[i3*dof+2, i4*dof+4] += 0.166666666666667*Ac2*(G45*(0.166666666666667*b1 - 0.166666666666667*d1) + G55*(-0.166666666666667*a1 + 0.166666666666667*c1))/Ac
        k0[i3*dof+3, i1*dof+2] += 0.166666666666667*Ac1*G44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))/Ac + 0.166666666666667*Ac1*G45*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))/Ac
        k0[i3*dof+3, i1*dof+3] += 0.166666666666667*Ac1*G44*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))/Ac + 0.166666666666667*Ac1*G45*(a1*c1/4 - a2*c2/4)/Ac
        k0[i3*dof+3, i1*dof+4] += 0.166666666666667*Ac1*G44*(-b1*d1/4 + b2*d2/4)/Ac + 0.166666666666667*Ac1*G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))/Ac
        k0[i3*dof+3, i2*dof+2] += 0.166666666666667*Ac1*G44*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))/Ac + 0.166666666666667*Ac1*G45*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))/Ac
        k0[i3*dof+3, i2*dof+3] += 0.166666666666667*Ac1*G44*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))/Ac + 0.166666666666667*Ac1*G45*(-a1*c1/4 + a2*c2/4)/Ac
        k0[i3*dof+3, i2*dof+4] += 0.166666666666667*Ac1*G44*(b1*d1/4 - b2*d2/4)/Ac + 0.166666666666667*Ac1*G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))/Ac
        k0[i3*dof+3, i3*dof+2] += 0.166666666666667*Ac1*G44*(0.166666666666667*b1 - 0.166666666666667*d1)/Ac + 0.166666666666667*Ac1*G45*(-0.166666666666667*a1 + 0.166666666666667*c1)/Ac
        k0[i3*dof+3, i3*dof+3] += 0.0277777777777778*(Ac1*Ac1)*G44/Ac
        k0[i3*dof+3, i3*dof+4] += 0.0277777777777778*(Ac1*Ac1)*G45/Ac
        k0[i3*dof+3, i4*dof+2] += 0.166666666666667*Ac1*G44*(0.166666666666667*b2 - 0.166666666666667*d2)/Ac + 0.166666666666667*Ac1*G45*(-0.166666666666667*a2 + 0.166666666666667*c2)/Ac
        k0[i3*dof+3, i4*dof+3] += 0.0277777777777778*Ac1*Ac2*G44/Ac
        k0[i3*dof+3, i4*dof+4] += 0.0277777777777778*Ac1*Ac2*G45/Ac
        k0[i3*dof+4, i1*dof+2] += 0.166666666666667*Ac1*G45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))/Ac + 0.166666666666667*Ac1*G55*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))/Ac
        k0[i3*dof+4, i1*dof+3] += 0.166666666666667*Ac1*G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))/Ac + 0.166666666666667*Ac1*G55*(a1*c1/4 - a2*c2/4)/Ac
        k0[i3*dof+4, i1*dof+4] += 0.166666666666667*Ac1*G45*(-b1*d1/4 + b2*d2/4)/Ac + 0.166666666666667*Ac1*G55*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))/Ac
        k0[i3*dof+4, i2*dof+2] += 0.166666666666667*Ac1*G45*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))/Ac + 0.166666666666667*Ac1*G55*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))/Ac
        k0[i3*dof+4, i2*dof+3] += 0.166666666666667*Ac1*G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))/Ac + 0.166666666666667*Ac1*G55*(-a1*c1/4 + a2*c2/4)/Ac
        k0[i3*dof+4, i2*dof+4] += 0.166666666666667*Ac1*G45*(b1*d1/4 - b2*d2/4)/Ac + 0.166666666666667*Ac1*G55*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))/Ac
        k0[i3*dof+4, i3*dof+2] += 0.166666666666667*Ac1*G45*(0.166666666666667*b1 - 0.166666666666667*d1)/Ac + 0.166666666666667*Ac1*G55*(-0.166666666666667*a1 + 0.166666666666667*c1)/Ac
        k0[i3*dof+4, i3*dof+3] += 0.0277777777777778*(Ac1*Ac1)*G45/Ac
        k0[i3*dof+4, i3*dof+4] += 0.0277777777777778*(Ac1*Ac1)*G55/Ac
        k0[i3*dof+4, i4*dof+2] += 0.166666666666667*Ac1*G45*(0.166666666666667*b2 - 0.166666666666667*d2)/Ac + 0.166666666666667*Ac1*G55*(-0.166666666666667*a2 + 0.166666666666667*c2)/Ac
        k0[i3*dof+4, i4*dof+3] += 0.0277777777777778*Ac1*Ac2*G45/Ac
        k0[i3*dof+4, i4*dof+4] += 0.0277777777777778*Ac1*Ac2*G55/Ac
        k0[i4*dof+2, i1*dof+2] += (Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(0.166666666666667*b2 - 0.166666666666667*d2) + G55*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac + (Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(0.166666666666667*b2 - 0.166666666666667*d2) + G45*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac
        k0[i4*dof+2, i1*dof+3] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G44*(0.166666666666667*b2 - 0.166666666666667*d2) + G45*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac + (G45*(0.166666666666667*b2 - 0.166666666666667*d2) + G55*(-0.166666666666667*a2 + 0.166666666666667*c2))*(a1*c1/4 - a2*c2/4)/Ac
        k0[i4*dof+2, i1*dof+4] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G45*(0.166666666666667*b2 - 0.166666666666667*d2) + G55*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac + (G44*(0.166666666666667*b2 - 0.166666666666667*d2) + G45*(-0.166666666666667*a2 + 0.166666666666667*c2))*(-b1*d1/4 + b2*d2/4)/Ac
        k0[i4*dof+2, i2*dof+2] += (Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))*(G45*(0.166666666666667*b2 - 0.166666666666667*d2) + G55*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac + (Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))*(G44*(0.166666666666667*b2 - 0.166666666666667*d2) + G45*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac
        k0[i4*dof+2, i2*dof+3] += (Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))*(G44*(0.166666666666667*b2 - 0.166666666666667*d2) + G45*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac + (G45*(0.166666666666667*b2 - 0.166666666666667*d2) + G55*(-0.166666666666667*a2 + 0.166666666666667*c2))*(-a1*c1/4 + a2*c2/4)/Ac
        k0[i4*dof+2, i2*dof+4] += (Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))*(G45*(0.166666666666667*b2 - 0.166666666666667*d2) + G55*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac + (G44*(0.166666666666667*b2 - 0.166666666666667*d2) + G45*(-0.166666666666667*a2 + 0.166666666666667*c2))*(b1*d1/4 - b2*d2/4)/Ac
        k0[i4*dof+2, i3*dof+2] += (-0.166666666666667*a1 + 0.166666666666667*c1)*(G45*(0.166666666666667*b2 - 0.166666666666667*d2) + G55*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac + (0.166666666666667*b1 - 0.166666666666667*d1)*(G44*(0.166666666666667*b2 - 0.166666666666667*d2) + G45*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac
        k0[i4*dof+2, i3*dof+3] += 0.166666666666667*Ac1*(G44*(0.166666666666667*b2 - 0.166666666666667*d2) + G45*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac
        k0[i4*dof+2, i3*dof+4] += 0.166666666666667*Ac1*(G45*(0.166666666666667*b2 - 0.166666666666667*d2) + G55*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac
        k0[i4*dof+2, i4*dof+2] += (-0.166666666666667*a2 + 0.166666666666667*c2)*(G45*(0.166666666666667*b2 - 0.166666666666667*d2) + G55*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac + (0.166666666666667*b2 - 0.166666666666667*d2)*(G44*(0.166666666666667*b2 - 0.166666666666667*d2) + G45*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac
        k0[i4*dof+2, i4*dof+3] += 0.166666666666667*Ac2*(G44*(0.166666666666667*b2 - 0.166666666666667*d2) + G45*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac
        k0[i4*dof+2, i4*dof+4] += 0.166666666666667*Ac2*(G45*(0.166666666666667*b2 - 0.166666666666667*d2) + G55*(-0.166666666666667*a2 + 0.166666666666667*c2))/Ac
        k0[i4*dof+3, i1*dof+2] += 0.166666666666667*Ac2*G44*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))/Ac + 0.166666666666667*Ac2*G45*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))/Ac
        k0[i4*dof+3, i1*dof+3] += 0.166666666666667*Ac2*G44*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))/Ac + 0.166666666666667*Ac2*G45*(a1*c1/4 - a2*c2/4)/Ac
        k0[i4*dof+3, i1*dof+4] += 0.166666666666667*Ac2*G44*(-b1*d1/4 + b2*d2/4)/Ac + 0.166666666666667*Ac2*G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))/Ac
        k0[i4*dof+3, i2*dof+2] += 0.166666666666667*Ac2*G44*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))/Ac + 0.166666666666667*Ac2*G45*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))/Ac
        k0[i4*dof+3, i2*dof+3] += 0.166666666666667*Ac2*G44*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))/Ac + 0.166666666666667*Ac2*G45*(-a1*c1/4 + a2*c2/4)/Ac
        k0[i4*dof+3, i2*dof+4] += 0.166666666666667*Ac2*G44*(b1*d1/4 - b2*d2/4)/Ac + 0.166666666666667*Ac2*G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))/Ac
        k0[i4*dof+3, i3*dof+2] += 0.166666666666667*Ac2*G44*(0.166666666666667*b1 - 0.166666666666667*d1)/Ac + 0.166666666666667*Ac2*G45*(-0.166666666666667*a1 + 0.166666666666667*c1)/Ac
        k0[i4*dof+3, i3*dof+3] += 0.0277777777777778*Ac1*Ac2*G44/Ac
        k0[i4*dof+3, i3*dof+4] += 0.0277777777777778*Ac1*Ac2*G45/Ac
        k0[i4*dof+3, i4*dof+2] += 0.166666666666667*Ac2*G44*(0.166666666666667*b2 - 0.166666666666667*d2)/Ac + 0.166666666666667*Ac2*G45*(-0.166666666666667*a2 + 0.166666666666667*c2)/Ac
        k0[i4*dof+3, i4*dof+3] += 0.0277777777777778*(Ac2*Ac2)*G44/Ac
        k0[i4*dof+3, i4*dof+4] += 0.0277777777777778*(Ac2*Ac2)*G45/Ac
        k0[i4*dof+4, i1*dof+2] += 0.166666666666667*Ac2*G45*(Ac1*(-b1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(d2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))/Ac + 0.166666666666667*Ac2*G55*(Ac1*(a1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(-c2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))/Ac
        k0[i4*dof+4, i1*dof+3] += 0.166666666666667*Ac2*G45*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))/Ac + 0.166666666666667*Ac2*G55*(a1*c1/4 - a2*c2/4)/Ac
        k0[i4*dof+4, i1*dof+4] += 0.166666666666667*Ac2*G45*(-b1*d1/4 + b2*d2/4)/Ac + 0.166666666666667*Ac2*G55*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))/Ac
        k0[i4*dof+4, i2*dof+2] += 0.166666666666667*Ac2*G45*(Ac1*(d1/(2*Ac1) + 0.166666666666667*(b1 - d1)/Ac1) + Ac2*(-b2/(2*Ac2) + 0.166666666666667*(b2 - d2)/Ac2))/Ac + 0.166666666666667*Ac2*G55*(Ac1*(-c1/(2*Ac1) + 0.166666666666667*(-a1 + c1)/Ac1) + Ac2*(a2/(2*Ac2) + 0.166666666666667*(-a2 + c2)/Ac2))/Ac
        k0[i4*dof+4, i2*dof+3] += 0.166666666666667*Ac2*G45*(Ac1*(0.166666666666667 + a1*d1/(4*Ac1)) + Ac2*(0.166666666666667 - b2*c2/(4*Ac2)))/Ac + 0.166666666666667*Ac2*G55*(-a1*c1/4 + a2*c2/4)/Ac
        k0[i4*dof+4, i2*dof+4] += 0.166666666666667*Ac2*G45*(b1*d1/4 - b2*d2/4)/Ac + 0.166666666666667*Ac2*G55*(Ac1*(0.166666666666667 - b1*c1/(4*Ac1)) + Ac2*(0.166666666666667 + a2*d2/(4*Ac2)))/Ac
        k0[i4*dof+4, i3*dof+2] += 0.166666666666667*Ac2*G45*(0.166666666666667*b1 - 0.166666666666667*d1)/Ac + 0.166666666666667*Ac2*G55*(-0.166666666666667*a1 + 0.166666666666667*c1)/Ac
        k0[i4*dof+4, i3*dof+3] += 0.0277777777777778*Ac1*Ac2*G45/Ac
        k0[i4*dof+4, i3*dof+4] += 0.0277777777777778*Ac1*Ac2*G55/Ac
        k0[i4*dof+4, i4*dof+2] += 0.166666666666667*Ac2*G45*(0.166666666666667*b2 - 0.166666666666667*d2)/Ac + 0.166666666666667*Ac2*G55*(-0.166666666666667*a2 + 0.166666666666667*c2)/Ac
        k0[i4*dof+4, i4*dof+3] += 0.0277777777777778*(Ac2*Ac2)*G45/Ac
        k0[i4*dof+4, i4*dof+4] += 0.0277777777777778*(Ac2*Ac2)*G55/Ac

    print('finished!')
    return k0
